[
    {
        "id": "f817f6a7671b1a08",
        "type": "tab",
        "label": "Keyrock",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "92d8fd98132b13ea",
        "type": "tab",
        "label": "IoT Agent",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "7054fec8bee5107d",
        "type": "tab",
        "label": "Orion",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "e9891387af72915b",
        "type": "tab",
        "label": "SENSORES Y ACTUADORES",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "66697df425b4ad85",
        "type": "tab",
        "label": "APP",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "566d3f2244bf2252",
        "type": "tab",
        "label": "Keyrock F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "b7399fc069e83146",
        "type": "tab",
        "label": "IoT Agent F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "459510cbb9db9ba8",
        "type": "tab",
        "label": "Orion F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "005d0f43a69b7907",
        "type": "tab",
        "label": "Electrico F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "68944cea84c8b461",
        "type": "tab",
        "label": "Hidraulico F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "2c53247ebc271023",
        "type": "tab",
        "label": "Aislamiento F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "cc2710ecf2b1876d",
        "type": "tab",
        "label": "Ventilacion F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "e2ba746ef9983a33",
        "type": "tab",
        "label": "APP F",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "98a5db9935e06314",
        "type": "tab",
        "label": "Basura B",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "a802ef2933ec375e",
        "type": "mqtt-broker",
        "name": "Hive MQ",
        "broker": "10.0.2.15",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "80e9a69f51797b3e",
        "type": "mqtt-broker",
        "name": "Hive MQ (Usuario y Contrase√±a)",
        "broker": "10.0.2.15",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "a5e11d29c103c79c",
        "type": "tls-config",
        "name": "",
        "cert": "",
        "key": "",
        "ca": "",
        "certname": "10.0.2.15.crt",
        "keyname": "10.0.2.15.key",
        "caname": "rootCA.key",
        "servername": "",
        "verifyservercert": false,
        "alpnprotocol": ""
    },
    {
        "id": "405695e50f5ae861",
        "type": "mqtt-broker",
        "name": "Hive MQ (SSL/TLS)",
        "broker": "192.168.42.50",
        "port": "8883",
        "tls": "a5e11d29c103c79c",
        "clientid": "",
        "autoConnect": true,
        "usetls": true,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "9df126bc4f38bf1b",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "a248de7ade6e2f2d",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "95bc0ee9d93efab4",
        "type": "ui_group",
        "name": "HomePage",
        "tab": "9df126bc4f38bf1b",
        "order": 1,
        "disp": true,
        "width": "16",
        "collapse": false,
        "className": ""
    },
    {
        "id": "99aebcd78c1fc320",
        "type": "inject",
        "z": "f817f6a7671b1a08",
        "name": "flow variables",
        "props": [
            {
                "p": "keyrock_ip",
                "v": "192.168.40.10",
                "vt": "str"
            },
            {
                "p": "keyrock_puerto",
                "v": "3443",
                "vt": "str"
            },
            {
                "p": "keyrock_oauth2_client_id",
                "v": "d6ef7f8c-7c70-4b59-8e3d-121bcd316d47",
                "vt": "str"
            },
            {
                "p": "keyrock_oauth2_client_secret",
                "v": "79f7a7b3-fe5c-47c5-a3e5-c69592e2a47a",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 60,
        "wires": [
            [
                "8404c4b135ff9b53"
            ]
        ]
    },
    {
        "id": "8404c4b135ff9b53",
        "type": "change",
        "z": "f817f6a7671b1a08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "keyrock_ip",
                "pt": "flow",
                "to": "keyrock_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "keyrock_puerto",
                "pt": "flow",
                "to": "keyrock_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "keyrock_oauth2_client_id",
                "pt": "flow",
                "to": "keyrock_oauth2_client_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "keyrock_oauth2_client_secret",
                "pt": "flow",
                "to": "keyrock_oauth2_client_secret",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "fadcbbf828cf1cc6",
        "type": "comment",
        "z": "f817f6a7671b1a08",
        "name": "OAuth2 Token",
        "info": "",
        "x": 130,
        "y": 140,
        "wires": []
    },
    {
        "id": "9fa076214d57930e",
        "type": "comment",
        "z": "f817f6a7671b1a08",
        "name": "Get OAuth2 token",
        "info": "",
        "x": 190,
        "y": 180,
        "wires": []
    },
    {
        "id": "659f04d50c1867aa",
        "type": "comment",
        "z": "f817f6a7671b1a08",
        "name": "Get OAuth2 token: admin",
        "info": "",
        "x": 210,
        "y": 220,
        "wires": []
    },
    {
        "id": "ba12e026049f5d61",
        "type": "comment",
        "z": "f817f6a7671b1a08",
        "name": "Get OAuth2 token: admin (permanent)",
        "info": "",
        "x": 250,
        "y": 340,
        "wires": []
    },
    {
        "id": "3f2e59a1bcd6c4d1",
        "type": "inject",
        "z": "f817f6a7671b1a08",
        "name": "execute request",
        "props": [
            {
                "p": "keyrock_ip",
                "v": "keyrock_ip",
                "vt": "flow"
            },
            {
                "p": "keyrock_puerto",
                "v": "keyrock_puerto",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_id",
                "v": "keyrock_oauth2_client_id",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_secret",
                "v": "keyrock_oauth2_client_secret",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "username=admin@test.com&password=1234567890&grant_type=password",
        "payloadType": "str",
        "x": 200,
        "y": 260,
        "wires": [
            [
                "cf62b1799b4e981f"
            ]
        ]
    },
    {
        "id": "aa5edb83c0162e6d",
        "type": "inject",
        "z": "f817f6a7671b1a08",
        "name": "execute request",
        "props": [
            {
                "p": "keyrock_ip",
                "v": "keyrock_ip",
                "vt": "flow"
            },
            {
                "p": "keyrock_puerto",
                "v": "keyrock_puerto",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_id",
                "v": "keyrock_oauth2_client_id",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_secret",
                "v": "keyrock_oauth2_client_secret",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "username=admin@test.com&password=1234567890&grant_type=password&scope=permanent",
        "payloadType": "str",
        "x": 200,
        "y": 300,
        "wires": [
            [
                "cf62b1799b4e981f"
            ]
        ]
    },
    {
        "id": "cf62b1799b4e981f",
        "type": "http request",
        "z": "f817f6a7671b1a08",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{keyrock_oauth2_client_id}}}:{{{keyrock_oauth2_client_secret}}}@{{{keyrock_ip}}}:{{{keyrock_puerto}}}/oauth2/token",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/x-www-form-urlencoded"
            }
        ],
        "x": 410,
        "y": 280,
        "wires": [
            [
                "c24d14ef18de6f27"
            ]
        ]
    },
    {
        "id": "c24d14ef18de6f27",
        "type": "json",
        "z": "f817f6a7671b1a08",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 280,
        "wires": [
            [
                "6076f249899ffa4b",
                "cb3fcb269600653a"
            ]
        ]
    },
    {
        "id": "6076f249899ffa4b",
        "type": "debug",
        "z": "f817f6a7671b1a08",
        "name": "get oauth2 token",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 280,
        "wires": []
    },
    {
        "id": "cb3fcb269600653a",
        "type": "change",
        "z": "f817f6a7671b1a08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "global",
                "to": "payload.access_token",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 970,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "afda95cebe7746db",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "192.168.42.10",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 60,
        "wires": [
            [
                "7a94521ccf179fd6"
            ]
        ]
    },
    {
        "id": "7a94521ccf179fd6",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "c9f4c27a7741969a",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Services",
        "info": "",
        "x": 120,
        "y": 140,
        "wires": []
    },
    {
        "id": "16c338400db86c19",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Get services",
        "info": "",
        "x": 170,
        "y": 180,
        "wires": []
    },
    {
        "id": "a69434ddc5e040ea",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 220,
        "wires": [
            [
                "10f08a66cf41e5b5"
            ]
        ]
    },
    {
        "id": "10f08a66cf41e5b5",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 220,
        "wires": [
            [
                "dfe50a4f024c0c11"
            ]
        ]
    },
    {
        "id": "dfe50a4f024c0c11",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 220,
        "wires": [
            [
                "6f7381788c9295a7"
            ]
        ]
    },
    {
        "id": "6f7381788c9295a7",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "get services",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 220,
        "wires": []
    },
    {
        "id": "c157c73d38697fe2",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Create services",
        "info": "",
        "x": 180,
        "y": 300,
        "wires": []
    },
    {
        "id": "d98453ced16c3a00",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"services\":[{\"apikey\":\"1234567890\",\"cbroker\":\"https://192.168.42.20:1026\",\"entity_type\":\"Thing\",\"resource\":\"/iot/json\"}]}",
        "payloadType": "json",
        "x": 200,
        "y": 340,
        "wires": [
            [
                "bcb967bbe5180d32"
            ]
        ]
    },
    {
        "id": "bcb967bbe5180d32",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 340,
        "wires": [
            [
                "13e8d9d188e778ea"
            ]
        ]
    },
    {
        "id": "8c99d36725dfef8e",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 380,
        "wires": [
            [
                "61b84aa178332fca"
            ]
        ]
    },
    {
        "id": "61b84aa178332fca",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "create services",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 340,
        "wires": []
    },
    {
        "id": "13e8d9d188e778ea",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 340,
        "wires": [
            [
                "61b84aa178332fca"
            ],
            [
                "8c99d36725dfef8e"
            ]
        ]
    },
    {
        "id": "1f6be9ff9e76f8ee",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Delete service",
        "info": "",
        "x": 170,
        "y": 620,
        "wires": []
    },
    {
        "id": "8f8bd3fb4a121d10",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "resource",
                "v": "/iot/json",
                "vt": "str"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 660,
        "wires": [
            [
                "f5251f619e6f3e0d"
            ]
        ]
    },
    {
        "id": "f5251f619e6f3e0d",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services/?resource={{{resource}}}&apikey={{{api_key}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 660,
        "wires": [
            [
                "2091039f17f2fcc4"
            ]
        ]
    },
    {
        "id": "56381319bfcdbe75",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 700,
        "wires": [
            [
                "b79f69b92cd07dcb"
            ]
        ]
    },
    {
        "id": "b79f69b92cd07dcb",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "delete service",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 660,
        "wires": []
    },
    {
        "id": "2091039f17f2fcc4",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 660,
        "wires": [
            [
                "b79f69b92cd07dcb"
            ],
            [
                "56381319bfcdbe75"
            ]
        ]
    },
    {
        "id": "3ffc03a4698aa4bb",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Devices",
        "info": "",
        "x": 110,
        "y": 780,
        "wires": []
    },
    {
        "id": "864320f45b85e04f",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Get devices",
        "info": "",
        "x": 170,
        "y": 820,
        "wires": []
    },
    {
        "id": "92bdc6e458edf227",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 860,
        "wires": [
            [
                "b8741209fb59e72f"
            ]
        ]
    },
    {
        "id": "b8741209fb59e72f",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 860,
        "wires": [
            [
                "16f5721e7bbd7477"
            ]
        ]
    },
    {
        "id": "16f5721e7bbd7477",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 860,
        "wires": [
            [
                "b96cc9d6823ff655"
            ]
        ]
    },
    {
        "id": "b96cc9d6823ff655",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "get devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 860,
        "wires": []
    },
    {
        "id": "55e6da5ea007dff7",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Create devices",
        "info": "",
        "x": 180,
        "y": 940,
        "wires": []
    },
    {
        "id": "b09fb42b25c80308",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"devices\":[{\"device_id\":\"vc001\",\"entity_name\":\"urn:ngsi-ld:Calidad:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"quality\",\"type\":\"Number\"}]},{\"device_id\":\"vv001\",\"entity_name\":\"urn:ngsi-ld:Ventilador:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"on\",\"type\":\"Boolean\"}]},{\"device_id\":\"ev001\",\"entity_name\":\"urn:ngsi-ld:Viento:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"speed\",\"type\":\"Number\"}]},{\"device_id\":\"em001\",\"entity_name\":\"urn:ngsi-ld:Molino:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"on\",\"type\":\"Boolean\"}]},{\"device_id\":\"eb001\",\"entity_name\":\"urn:ngsi-ld:Bateria:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"on\",\"type\":\"Boolean\"}]},{\"device_id\":\"et001\",\"entity_name\":\"urn:ngsi-ld:TBateria:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"temp\",\"type\":\"Number\"}]},{\"device_id\":\"ae001\",\"entity_name\":\"urn:ngsi-ld:EPuerta:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"locked\",\"type\":\"Boolean\"}]},{\"device_id\":\"ai001\",\"entity_name\":\"urn:ngsi-ld:IPuerta:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"locked\",\"type\":\"Boolean\"}]},{\"device_id\":\"as001\",\"entity_name\":\"urn:ngsi-ld:SIncendios:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"alarm\",\"type\":\"Boolean\"}]},{\"device_id\":\"hc001\",\"entity_name\":\"urn:ngsi-ld:Compuertas:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"locked\",\"type\":\"Boolean\"}]},{\"device_id\":\"hca001\",\"entity_name\":\"urn:ngsi-ld:CalidadAgua:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"quality\",\"type\":\"Number\"}]},{\"device_id\":\"hct001\",\"entity_name\":\"urn:ngsi-ld:CapacidadTanque:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"capacity\",\"type\":\"Number\"}]}]}",
        "payloadType": "json",
        "x": 200,
        "y": 980,
        "wires": [
            [
                "910e41bf82b438a0"
            ]
        ]
    },
    {
        "id": "910e41bf82b438a0",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 980,
        "wires": [
            [
                "5a924d66d96828e6",
                "ef703bfbfa4f22d5"
            ]
        ]
    },
    {
        "id": "e7b76bb6f5b7392b",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 1020,
        "wires": [
            [
                "57ca771fa2d33763"
            ]
        ]
    },
    {
        "id": "57ca771fa2d33763",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "create devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 980,
        "wires": []
    },
    {
        "id": "5a924d66d96828e6",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 980,
        "wires": [
            [
                "57ca771fa2d33763"
            ],
            [
                "e7b76bb6f5b7392b"
            ]
        ]
    },
    {
        "id": "fe690796cfab3f25",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Delete devices",
        "info": "",
        "x": 180,
        "y": 1100,
        "wires": []
    },
    {
        "id": "02585d670356c2aa",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "et001",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 1180,
        "wires": [
            [
                "ae02c784ab5505f5"
            ]
        ]
    },
    {
        "id": "ae02c784ab5505f5",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices/{{{device_id}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 1200,
        "wires": [
            [
                "9fccb76d487e1355"
            ]
        ]
    },
    {
        "id": "0fd8bff55fa49e4e",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 1240,
        "wires": [
            [
                "307ab2c17874330c"
            ]
        ]
    },
    {
        "id": "307ab2c17874330c",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "delete device",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 1200,
        "wires": []
    },
    {
        "id": "9fccb76d487e1355",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 1200,
        "wires": [
            [
                "307ab2c17874330c"
            ],
            [
                "0fd8bff55fa49e4e"
            ]
        ]
    },
    {
        "id": "190fba59b83122fa",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Delete device: lamp001",
        "info": "",
        "x": 200,
        "y": 1140,
        "wires": []
    },
    {
        "id": "1d00429a9d2c90c5",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "ev001",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 1220,
        "wires": [
            [
                "ae02c784ab5505f5"
            ]
        ]
    },
    {
        "id": "11a0fbe2030b62e6",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Delete device: lamp002",
        "info": "",
        "x": 200,
        "y": 1260,
        "wires": []
    },
    {
        "id": "469b25b5a007d452",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Update devices",
        "info": "",
        "x": 180,
        "y": 1340,
        "wires": []
    },
    {
        "id": "9447ebf1741a1cac",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp001",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"o\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 1420,
        "wires": [
            [
                "a979b20a7b5672ec"
            ]
        ]
    },
    {
        "id": "a979b20a7b5672ec",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 1440,
        "wires": [
            [
                "bcd885fa6993b402"
            ]
        ]
    },
    {
        "id": "c01e70fc451af416",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 1480,
        "wires": [
            [
                "20b49813fd8b3f91"
            ]
        ]
    },
    {
        "id": "20b49813fd8b3f91",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 1440,
        "wires": []
    },
    {
        "id": "bcd885fa6993b402",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 1440,
        "wires": [
            [
                "20b49813fd8b3f91"
            ],
            [
                "c01e70fc451af416"
            ]
        ]
    },
    {
        "id": "6e0fa1035c157295",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Update device lamp001: set on to 0",
        "info": "",
        "x": 240,
        "y": 1380,
        "wires": []
    },
    {
        "id": "0b0be8ae90f3ff06",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp001",
                "vt": "str"
            },
            {
                "p": "payload"
            },
            {
                "p": "rejectUnauthorized",
                "v": "false",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"o\":1}",
        "payloadType": "json",
        "x": 200,
        "y": 1460,
        "wires": [
            [
                "a979b20a7b5672ec"
            ]
        ]
    },
    {
        "id": "5a116cb68991e0e7",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Update device lamp001: set on to 1",
        "info": "",
        "x": 240,
        "y": 1500,
        "wires": []
    },
    {
        "id": "0676e8974314834c",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp002",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"on\":0}",
        "payloadType": "json",
        "x": 200,
        "y": 1620,
        "wires": [
            [
                "32dbbe4b64bcb3df"
            ]
        ]
    },
    {
        "id": "32dbbe4b64bcb3df",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 1640,
        "wires": [
            [
                "a5967ce22ebdec24"
            ]
        ]
    },
    {
        "id": "a09a2d87a00a243d",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 1680,
        "wires": [
            [
                "165ee383cfc8dc52"
            ]
        ]
    },
    {
        "id": "165ee383cfc8dc52",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 1640,
        "wires": []
    },
    {
        "id": "a5967ce22ebdec24",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 1640,
        "wires": [
            [
                "165ee383cfc8dc52"
            ],
            [
                "a09a2d87a00a243d"
            ]
        ]
    },
    {
        "id": "f484a019722523a7",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Update device lamp002: set on to 0",
        "info": "",
        "x": 240,
        "y": 1580,
        "wires": []
    },
    {
        "id": "c8a67eb65b249f95",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp002",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"on\":1}",
        "payloadType": "json",
        "x": 200,
        "y": 1660,
        "wires": [
            [
                "32dbbe4b64bcb3df"
            ]
        ]
    },
    {
        "id": "f7c6aeeaa4101a3b",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Update device lamp002: set on to 1",
        "info": "",
        "x": 240,
        "y": 1700,
        "wires": []
    },
    {
        "id": "d1b393f505c05540",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "Inject permanent key to service",
        "info": "",
        "x": 230,
        "y": 460,
        "wires": []
    },
    {
        "id": "3396a78f4d1baf2f",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "resource",
                "v": "/iot/json",
                "vt": "str"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\t    \"cbroker\": \"https://192.168.42.20:1026\",\t    \"trust\": $globalContext(\"oauth2-token\")\t}",
        "payloadType": "jsonata",
        "x": 200,
        "y": 500,
        "wires": [
            [
                "7fdc4439958bdb13"
            ]
        ]
    },
    {
        "id": "7fdc4439958bdb13",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "PUT",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services/?resource={{{resource}}}&apikey={{{api_key}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 500,
        "wires": [
            [
                "3af0ac09d8e2fc51"
            ]
        ]
    },
    {
        "id": "184d09ddccd6a54f",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 540,
        "wires": [
            [
                "1f0ea1c816ef4e66"
            ]
        ]
    },
    {
        "id": "1f0ea1c816ef4e66",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "inject permanent key to service",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 500,
        "wires": []
    },
    {
        "id": "3af0ac09d8e2fc51",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 500,
        "wires": [
            [
                "1f0ea1c816ef4e66"
            ],
            [
                "184d09ddccd6a54f"
            ]
        ]
    },
    {
        "id": "ef703bfbfa4f22d5",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "debug 4",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 920,
        "wires": []
    },
    {
        "id": "a81d3b5dc582f44b",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 2180,
        "wires": [
            [
                "8ed633444144507b",
                "42f4fa61ff6c5da5",
                "a9d6394f969abd77",
                "baaf49c287c2603e",
                "e35b8cf389b68690",
                "271dbb24f6c54b5a",
                "0b9dfb727a320863",
                "692da0ba0f351fd9",
                "595694dc534b4ac5",
                "c31dc995def4fde1",
                "a7e27477b0510288",
                "8afc857a0710eed6"
            ]
        ]
    },
    {
        "id": "2ef6ee7c5c8fd52a",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 830,
        "y": 2180,
        "wires": [
            [
                "788a9a7395a1a13b"
            ]
        ]
    },
    {
        "id": "e19b650824b3b37f",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1130,
        "y": 2180,
        "wires": [
            [
                "b02e56ad3daa9ead"
            ]
        ]
    },
    {
        "id": "b02e56ad3daa9ead",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1280,
        "y": 2180,
        "wires": []
    },
    {
        "id": "788a9a7395a1a13b",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1010,
        "y": 2180,
        "wires": [
            [
                "b02e56ad3daa9ead"
            ],
            [
                "e19b650824b3b37f"
            ]
        ]
    },
    {
        "id": "8ed633444144507b",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vc001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"quality\": 95}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1880,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "3b639b5376847252",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "SET INITIAL VALUES OF DEVICES",
        "info": "",
        "x": 220,
        "y": 1840,
        "wires": []
    },
    {
        "id": "42f4fa61ff6c5da5",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vv001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"on\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1940,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "a9d6394f969abd77",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ev001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"speed\": 50}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2000,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "baaf49c287c2603e",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "em001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"on\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2060,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "e35b8cf389b68690",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "eb001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"on\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2120,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "271dbb24f6c54b5a",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "et001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"temp\": 25}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2180,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "0b9dfb727a320863",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ae001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"locked\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2240,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "692da0ba0f351fd9",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ai001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"locked\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2300,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "595694dc534b4ac5",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "as001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"alarm\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2360,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "c31dc995def4fde1",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hc001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"locked\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2420,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "8afc857a0710eed6",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hca001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"quality\": 95}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2480,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "a7e27477b0510288",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hct001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"capacity\": 65}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 2540,
        "wires": [
            [
                "2ef6ee7c5c8fd52a"
            ]
        ]
    },
    {
        "id": "a37089732b370f96",
        "type": "inject",
        "z": "92d8fd98132b13ea",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 120,
        "y": 3000,
        "wires": [
            [
                "845f5433b14df17c",
                "5e85a4a570939668",
                "6e3641af194c094d",
                "3a4c4c6ecbc9d2a2",
                "912ce13f2d439165",
                "eb07e5e71e87d221",
                "119add5390bf123d",
                "7c82b63e9f9f6a2a",
                "afaaa8db8bcfe2a9",
                "a293e0bcca0b6d05",
                "5402607a85c07d85",
                "fa81f74f50f9366b"
            ]
        ]
    },
    {
        "id": "f3b6a6387e49278d",
        "type": "json",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1110,
        "y": 2980,
        "wires": [
            [
                "7057db3ddc4f4344"
            ]
        ]
    },
    {
        "id": "7057db3ddc4f4344",
        "type": "debug",
        "z": "92d8fd98132b13ea",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1260,
        "y": 2980,
        "wires": []
    },
    {
        "id": "c3bdbf1ff88b6113",
        "type": "switch",
        "z": "92d8fd98132b13ea",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 970,
        "y": 2980,
        "wires": [
            [
                "7057db3ddc4f4344"
            ],
            [
                "f3b6a6387e49278d"
            ]
        ]
    },
    {
        "id": "845f5433b14df17c",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vc001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2700,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "ebb4ad13c5d55596",
        "type": "comment",
        "z": "92d8fd98132b13ea",
        "name": "DELETE ALL DEVICES",
        "info": "",
        "x": 140,
        "y": 2640,
        "wires": []
    },
    {
        "id": "5e85a4a570939668",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vv001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2760,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "6e3641af194c094d",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ev001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2820,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "3a4c4c6ecbc9d2a2",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "em001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2880,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "912ce13f2d439165",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "eb001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2940,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "eb07e5e71e87d221",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "et001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3000,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "119add5390bf123d",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ae001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3060,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "7c82b63e9f9f6a2a",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ai001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3120,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "afaaa8db8bcfe2a9",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "as001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3180,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "a293e0bcca0b6d05",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hc001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3240,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "fa81f74f50f9366b",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hca001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3300,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "5402607a85c07d85",
        "type": "change",
        "z": "92d8fd98132b13ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hct001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 3360,
        "wires": [
            [
                "3bc0d37393eda8b2"
            ]
        ]
    },
    {
        "id": "3bc0d37393eda8b2",
        "type": "http request",
        "z": "92d8fd98132b13ea",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices/{{{device_id}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 810,
        "y": 2980,
        "wires": [
            [
                "c3bdbf1ff88b6113"
            ]
        ]
    },
    {
        "id": "8478081292e8f75a",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 60,
        "wires": [
            [
                "c4ae7c4d8859dada"
            ]
        ]
    },
    {
        "id": "c4ae7c4d8859dada",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "e5f87742103c22f6",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 180,
        "wires": [
            [
                "e62757f60f8d3c2c"
            ]
        ]
    },
    {
        "id": "2e4d60ebdee5e648",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 180,
        "wires": [
            [
                "32b4139a92f2c460"
            ]
        ]
    },
    {
        "id": "32b4139a92f2c460",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "orion version",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 180,
        "wires": []
    },
    {
        "id": "682ca218903955cf",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Check orion version",
        "info": "",
        "x": 190,
        "y": 140,
        "wires": []
    },
    {
        "id": "e62757f60f8d3c2c",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/version",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 180,
        "wires": [
            [
                "2e4d60ebdee5e648",
                "b35a69dcf02647e9"
            ]
        ]
    },
    {
        "id": "76dec3080a64dc12",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Entities",
        "info": "",
        "x": 150,
        "y": 240,
        "wires": []
    },
    {
        "id": "d21a6f6bcdf470ba",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Get entities",
        "info": "",
        "x": 170,
        "y": 300,
        "wires": []
    },
    {
        "id": "30be064efcb14deb",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 340,
        "wires": [
            [
                "1af99b4c98de8c0c"
            ]
        ]
    },
    {
        "id": "1af99b4c98de8c0c",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 340,
        "wires": [
            [
                "dc85eb069a6a3d69"
            ]
        ]
    },
    {
        "id": "dc85eb069a6a3d69",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 340,
        "wires": [
            [
                "e75be13027181133"
            ]
        ]
    },
    {
        "id": "e75be13027181133",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "get entities",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 340,
        "wires": []
    },
    {
        "id": "b4a9d1c78508b72f",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Delete entity",
        "info": "",
        "x": 170,
        "y": 420,
        "wires": []
    },
    {
        "id": "733b944ba9b0bc95",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "Thing:vc001",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 460,
        "wires": [
            [
                "9b18efd711f33d37"
            ]
        ]
    },
    {
        "id": "9b18efd711f33d37",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 460,
        "wires": [
            [
                "8daaa12956f641b6"
            ]
        ]
    },
    {
        "id": "6bdd20aaf07f69c1",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 500,
        "wires": [
            [
                "6f053ac64b5daac7"
            ]
        ]
    },
    {
        "id": "6f053ac64b5daac7",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "delete entity",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 460,
        "wires": []
    },
    {
        "id": "8daaa12956f641b6",
        "type": "switch",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 460,
        "wires": [
            [
                "6f053ac64b5daac7"
            ],
            [
                "6bdd20aaf07f69c1"
            ]
        ]
    },
    {
        "id": "02ea57af251f1453",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Entity attributes",
        "info": "",
        "x": 140,
        "y": 580,
        "wires": []
    },
    {
        "id": "1d9d726deb905f8d",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Get entity attribute: all",
        "info": "",
        "x": 200,
        "y": 620,
        "wires": []
    },
    {
        "id": "f41f1ebdd8610bf4",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "Thing:lamp002",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 660,
        "wires": [
            [
                "9de147ce6994653c"
            ]
        ]
    },
    {
        "id": "9de147ce6994653c",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 660,
        "wires": [
            [
                "9b42f963c4d62f5d"
            ]
        ]
    },
    {
        "id": "9b42f963c4d62f5d",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 660,
        "wires": [
            [
                "b597fe798f1f88dd"
            ]
        ]
    },
    {
        "id": "b597fe798f1f88dd",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "get entity attribute: all",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 660,
        "wires": []
    },
    {
        "id": "4cdb27e29c6be2d8",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Get entity attribute: on",
        "info": "",
        "x": 200,
        "y": 740,
        "wires": []
    },
    {
        "id": "b61e5a09fce7be13",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Lamp:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 780,
        "wires": [
            [
                "af20204629072774"
            ]
        ]
    },
    {
        "id": "287761bfbe953e9a",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 610,
        "y": 780,
        "wires": [
            [
                "de6f6f7b709321d4"
            ]
        ]
    },
    {
        "id": "de6f6f7b709321d4",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 780,
        "wires": [
            [
                "0193fa992c255b5d"
            ]
        ]
    },
    {
        "id": "0193fa992c255b5d",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "get entity attribute: on",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 780,
        "wires": []
    },
    {
        "id": "af20204629072774",
        "type": "trigger",
        "z": "7054fec8bee5107d",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-1",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 420,
        "y": 780,
        "wires": [
            [
                "287761bfbe953e9a"
            ]
        ]
    },
    {
        "id": "b35a69dcf02647e9",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "debug 2",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 120,
        "wires": []
    },
    {
        "id": "fccff133fa43d20e",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Calidad:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 940,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "8019be669ba7835e",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1000,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "ed70522b54eeb45a",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Viento:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1060,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "70edb664b865141b",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1120,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "67a85bbba4c3912d",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1180,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "0b608e27d66ffcbc",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:TBateria:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1240,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "43d42e339efdc124",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1320,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "f78099bf149aebe1",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1380,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "eb4a6881d65a4077",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:SIncendios:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1440,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "554efe3c00ce6d2b",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1500,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "0ec9c658ab7b0b4b",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:CapacidadTanque:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1560,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "d039760c91b7aa79",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:CalidadAgua:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1620,
        "wires": [
            [
                "eb32e90e33b68cd6"
            ]
        ]
    },
    {
        "id": "94cce532fb8b4d84",
        "type": "inject",
        "z": "7054fec8bee5107d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "Thing:lamp001",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 940,
        "wires": [
            [
                "fccff133fa43d20e",
                "8019be669ba7835e",
                "ed70522b54eeb45a",
                "70edb664b865141b",
                "67a85bbba4c3912d",
                "0b608e27d66ffcbc",
                "43d42e339efdc124",
                "f78099bf149aebe1",
                "eb4a6881d65a4077",
                "554efe3c00ce6d2b",
                "0ec9c658ab7b0b4b",
                "d039760c91b7aa79"
            ]
        ]
    },
    {
        "id": "eb32e90e33b68cd6",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 930,
        "y": 1320,
        "wires": [
            [
                "b1839476860cd220"
            ]
        ]
    },
    {
        "id": "73295e939a63b903",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1270,
        "y": 1360,
        "wires": [
            [
                "2e5e29e1e655f38f"
            ]
        ]
    },
    {
        "id": "2e5e29e1e655f38f",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "delete entity",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1450,
        "y": 1320,
        "wires": []
    },
    {
        "id": "b1839476860cd220",
        "type": "switch",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1110,
        "y": 1320,
        "wires": [
            [
                "2e5e29e1e655f38f"
            ],
            [
                "73295e939a63b903"
            ]
        ]
    },
    {
        "id": "d8d942f8fcae8553",
        "type": "change",
        "z": "7054fec8bee5107d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Viento:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2160,
        "y": 460,
        "wires": [
            [
                "1774896a7784518d"
            ]
        ]
    },
    {
        "id": "1774896a7784518d",
        "type": "http request",
        "z": "7054fec8bee5107d",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2350,
        "y": 460,
        "wires": [
            [
                "110ce0ae2605879f"
            ]
        ]
    },
    {
        "id": "9293765289b26674",
        "type": "json",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2670,
        "y": 480,
        "wires": [
            [
                "ada6111c125af1f8"
            ]
        ]
    },
    {
        "id": "ada6111c125af1f8",
        "type": "debug",
        "z": "7054fec8bee5107d",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2860,
        "y": 460,
        "wires": []
    },
    {
        "id": "110ce0ae2605879f",
        "type": "switch",
        "z": "7054fec8bee5107d",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2530,
        "y": 460,
        "wires": [
            [
                "ada6111c125af1f8"
            ],
            [
                "9293765289b26674"
            ]
        ]
    },
    {
        "id": "ae8f553f86700476",
        "type": "comment",
        "z": "7054fec8bee5107d",
        "name": "Delete entities",
        "info": "",
        "x": 190,
        "y": 880,
        "wires": []
    },
    {
        "id": "9dbb33cab06f6fad",
        "type": "inject",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "sco",
        "payload": "{\"o\":1}",
        "payloadType": "str",
        "x": 240,
        "y": 180,
        "wires": [
            [
                "f9c12d53aa58f654"
            ]
        ]
    },
    {
        "id": "f9c12d53aa58f654",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "d": true,
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 480,
        "y": 180,
        "wires": []
    },
    {
        "id": "4f2e4c354c90d2b4",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "ventilacion/calidad",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1370,
        "y": 1560,
        "wires": [
            [
                "e61fa2f5825d83d2",
                "ed3de45ee09cbe4e"
            ]
        ]
    },
    {
        "id": "e61fa2f5825d83d2",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "recevied data from Hive MQ (SSL/TLS)",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1670,
        "y": 1500,
        "wires": []
    },
    {
        "id": "54c59a41384deb2f",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1160,
        "y": 1560,
        "wires": []
    },
    {
        "id": "aec29c4ea58a4058",
        "type": "function",
        "z": "e9891387af72915b",
        "name": "function 1",
        "func": "\nconst r = Math.random() * 100;\nlet value = msg.calidad_aire ?? 95\nif(value < 70) {\n    value = 95\n}\nif (r <=20 && value > 65) {\n    value -= 1\n} else if (r >= 80 && value < 100) {\n    value += 1\n}\nmsg.payload = {\"quality\": value}\nmsg.calidad_aire = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 1560,
        "wires": [
            [
                "54c59a41384deb2f",
                "309ad082a26a3dc7"
            ]
        ]
    },
    {
        "id": "de3a9f18e4cb9a2a",
        "type": "inject",
        "z": "e9891387af72915b",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "192.168.42.10",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 250,
        "y": 260,
        "wires": [
            [
                "c6ec2cdea656ea3b"
            ]
        ]
    },
    {
        "id": "c6ec2cdea656ea3b",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "ed3de45ee09cbe4e",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vc001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 1560,
        "wires": [
            [
                "eb66f4247665c72b"
            ]
        ]
    },
    {
        "id": "eb66f4247665c72b",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 1790,
        "y": 1560,
        "wires": [
            [
                "003dec97bb626d6e"
            ]
        ]
    },
    {
        "id": "7cb1f0e17ed702a4",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2090,
        "y": 1580,
        "wires": [
            [
                "67516e659d6af62f"
            ]
        ]
    },
    {
        "id": "67516e659d6af62f",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "update devices",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2280,
        "y": 1560,
        "wires": []
    },
    {
        "id": "003dec97bb626d6e",
        "type": "switch",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1950,
        "y": 1560,
        "wires": [
            [
                "67516e659d6af62f"
            ],
            [
                "7cb1f0e17ed702a4"
            ]
        ]
    },
    {
        "id": "c26cf72ba7ea3cd8",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "ACTUADORES",
        "info": "",
        "x": 140,
        "y": 560,
        "wires": []
    },
    {
        "id": "c6f261cdc1aaab2d",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Get Ventilador Value",
        "info": "",
        "x": 550,
        "y": 620,
        "wires": []
    },
    {
        "id": "3d166ad6a0baed6d",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 790,
        "y": 660,
        "wires": [
            [
                "21d4cf663b0ba120"
            ]
        ]
    },
    {
        "id": "21d4cf663b0ba120",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 970,
        "y": 660,
        "wires": [
            [
                "2b556029e5e70aa2"
            ]
        ]
    },
    {
        "id": "a68d54f319a48fbc",
        "type": "inject",
        "z": "e9891387af72915b",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 250,
        "y": 320,
        "wires": [
            [
                "d35503254f9cfbbd"
            ]
        ]
    },
    {
        "id": "d35503254f9cfbbd",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "9c590dd38934232d",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1400,
        "y": 660,
        "wires": []
    },
    {
        "id": "0445fc7ee1ce32f8",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "ventilacion/ventilador",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1630,
        "y": 660,
        "wires": [
            [
                "e58937583f29cf3e"
            ]
        ]
    },
    {
        "id": "2b556029e5e70aa2",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ventilacion/ventilador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 660,
        "wires": [
            [
                "9c590dd38934232d"
            ]
        ]
    },
    {
        "id": "e58937583f29cf3e",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 3",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 660,
        "wires": []
    },
    {
        "id": "795894b1ed9d887d",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "SENSORES",
        "info": "",
        "x": 90,
        "y": 1460,
        "wires": []
    },
    {
        "id": "467a12e2553d6a31",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Get Molino  Value",
        "info": "",
        "x": 540,
        "y": 740,
        "wires": []
    },
    {
        "id": "b0ca9a4b96193de7",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 790,
        "y": 780,
        "wires": [
            [
                "bed907ceb34a25b5"
            ]
        ]
    },
    {
        "id": "bed907ceb34a25b5",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 970,
        "y": 780,
        "wires": [
            [
                "9463bf0ce5ee8aaf"
            ]
        ]
    },
    {
        "id": "ffd72757e6e26215",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1400,
        "y": 780,
        "wires": []
    },
    {
        "id": "86b4e09808f0a2d2",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "electricidad/molino",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1630,
        "y": 780,
        "wires": [
            [
                "a881ccb1e93ee783"
            ]
        ]
    },
    {
        "id": "9463bf0ce5ee8aaf",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "electricidad/molino",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 780,
        "wires": [
            [
                "ffd72757e6e26215"
            ]
        ]
    },
    {
        "id": "a881ccb1e93ee783",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 5",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 780,
        "wires": []
    },
    {
        "id": "f7c0378a1f8e0ca8",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Get Bateria Activated  Value",
        "info": "",
        "x": 580,
        "y": 860,
        "wires": []
    },
    {
        "id": "aee7e0c9640a795a",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 790,
        "y": 900,
        "wires": [
            [
                "a8d0fe9cd42c5291"
            ]
        ]
    },
    {
        "id": "a8d0fe9cd42c5291",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 970,
        "y": 900,
        "wires": [
            [
                "ed133a879d569d09"
            ]
        ]
    },
    {
        "id": "4ad8c127c5f5e365",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1400,
        "y": 900,
        "wires": []
    },
    {
        "id": "0f3650a0799d972c",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "electricidad/bateria",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1630,
        "y": 900,
        "wires": [
            [
                "93c074dbfb72a642"
            ]
        ]
    },
    {
        "id": "ed133a879d569d09",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "electricidad/bateria",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 900,
        "wires": [
            [
                "4ad8c127c5f5e365"
            ]
        ]
    },
    {
        "id": "93c074dbfb72a642",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 6",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 900,
        "wires": []
    },
    {
        "id": "089e1e44bbb2bc06",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Get EPuerta Locked  Value",
        "info": "",
        "x": 570,
        "y": 1000,
        "wires": []
    },
    {
        "id": "e83c5a446c25b99e",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 790,
        "y": 1040,
        "wires": [
            [
                "9030ffd46c783b80"
            ]
        ]
    },
    {
        "id": "9030ffd46c783b80",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 970,
        "y": 1040,
        "wires": [
            [
                "cb57718237f8cf14"
            ]
        ]
    },
    {
        "id": "55d48b120dbb5f89",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1400,
        "y": 1040,
        "wires": []
    },
    {
        "id": "c0990b9b4f38e8d8",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "aislamiento/epuerta",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1630,
        "y": 1040,
        "wires": [
            [
                "cc8407d6ee5f06dd"
            ]
        ]
    },
    {
        "id": "cb57718237f8cf14",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "aislamiento/epuerta",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 1040,
        "wires": [
            [
                "55d48b120dbb5f89"
            ]
        ]
    },
    {
        "id": "cc8407d6ee5f06dd",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 7",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 1040,
        "wires": []
    },
    {
        "id": "7359e1f518c2b08f",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Get IPuerta Locked  Value",
        "info": "",
        "x": 570,
        "y": 1140,
        "wires": []
    },
    {
        "id": "bea3c848e428a59a",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 790,
        "y": 1180,
        "wires": [
            [
                "62e93be744283466"
            ]
        ]
    },
    {
        "id": "62e93be744283466",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 970,
        "y": 1180,
        "wires": [
            [
                "cd7418f962852c4d"
            ]
        ]
    },
    {
        "id": "fd2d5fd4f7de30dd",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1400,
        "y": 1180,
        "wires": []
    },
    {
        "id": "31c00662b84bc45a",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "aislamiento/ipuerta",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1630,
        "y": 1180,
        "wires": [
            [
                "219dcc8913c171a2"
            ]
        ]
    },
    {
        "id": "cd7418f962852c4d",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "aislamiento/ipuerta",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 1180,
        "wires": [
            [
                "fd2d5fd4f7de30dd"
            ]
        ]
    },
    {
        "id": "219dcc8913c171a2",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 8",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 1180,
        "wires": []
    },
    {
        "id": "8d301a249795d2a9",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Get Hidraulico Compuertas  Value",
        "info": "",
        "x": 590,
        "y": 1260,
        "wires": []
    },
    {
        "id": "28481ea6c3fae147",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 790,
        "y": 1300,
        "wires": [
            [
                "1489da6934cc7a46"
            ]
        ]
    },
    {
        "id": "1489da6934cc7a46",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 970,
        "y": 1300,
        "wires": [
            [
                "afd09a685cacf560"
            ]
        ]
    },
    {
        "id": "380fa2519e8f6231",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1400,
        "y": 1300,
        "wires": []
    },
    {
        "id": "2e6a16eab3cc3fd6",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "hidraulico/compuertas",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1630,
        "y": 1300,
        "wires": [
            [
                "9ed418945207860b"
            ]
        ]
    },
    {
        "id": "afd09a685cacf560",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "hidraulico/compuertas",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 1300,
        "wires": [
            [
                "380fa2519e8f6231"
            ]
        ]
    },
    {
        "id": "9ed418945207860b",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 1300,
        "wires": []
    },
    {
        "id": "309ad082a26a3dc7",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "calidad_aire",
                "pt": "flow",
                "to": "calidad_aire",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 1640,
        "wires": [
            [
                "c6a482ffef5c2df8"
            ]
        ]
    },
    {
        "id": "c6a482ffef5c2df8",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 1",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 1640,
        "wires": []
    },
    {
        "id": "d278e01001b97fad",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Set Calidad Aire Value",
        "info": "",
        "x": 800,
        "y": 1520,
        "wires": []
    },
    {
        "id": "c01730705b5a303a",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "electricidad/tbateria",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1370,
        "y": 1800,
        "wires": [
            [
                "9b8c683eea13e0fa",
                "3b1a6f240059b429"
            ]
        ]
    },
    {
        "id": "9b8c683eea13e0fa",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "recevied data from Hive MQ (SSL/TLS)",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1670,
        "y": 1740,
        "wires": []
    },
    {
        "id": "e3dd98642a7b1ac3",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1160,
        "y": 1800,
        "wires": []
    },
    {
        "id": "81f33317742dbdc2",
        "type": "function",
        "z": "e9891387af72915b",
        "name": "function 2",
        "func": "\nconst r = Math.random() * 100;\nlet value = msg.temp_bateria ?? 25\nif(value > 50 || value < 5) {\n    value = 25\n}\nif (r <=10 && value > 0) {\n    value -= 1\n} else if (r >= 90 && value < 100) {\n    value += 1\n}\nmsg.payload = {\"temp\": value}\nmsg.temp_bateria = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 1800,
        "wires": [
            [
                "e3dd98642a7b1ac3",
                "b5282cbeddd4da32"
            ]
        ]
    },
    {
        "id": "3b1a6f240059b429",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "et001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 1800,
        "wires": [
            [
                "32c1ca88841cd107"
            ]
        ]
    },
    {
        "id": "32c1ca88841cd107",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 1790,
        "y": 1800,
        "wires": [
            [
                "7730349ce1930f07"
            ]
        ]
    },
    {
        "id": "f91b7c3b207ec0f9",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2090,
        "y": 1820,
        "wires": [
            [
                "58714a212f4b67d6"
            ]
        ]
    },
    {
        "id": "58714a212f4b67d6",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "update devices",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2280,
        "y": 1800,
        "wires": []
    },
    {
        "id": "7730349ce1930f07",
        "type": "switch",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1950,
        "y": 1800,
        "wires": [
            [
                "58714a212f4b67d6"
            ],
            [
                "f91b7c3b207ec0f9"
            ]
        ]
    },
    {
        "id": "b5282cbeddd4da32",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "temp_bateria",
                "pt": "flow",
                "to": "temp_bateria",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 1880,
        "wires": [
            [
                "17644e59ad807d94"
            ]
        ]
    },
    {
        "id": "17644e59ad807d94",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 12",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1320,
        "y": 1880,
        "wires": []
    },
    {
        "id": "fdbb68f6e8067879",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Set Temperatura Bateria Value",
        "info": "",
        "x": 820,
        "y": 1760,
        "wires": []
    },
    {
        "id": "f7e73366ab3bec1a",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "d": true,
        "name": "Hive MQ (SSL/TLS)",
        "topic": "electricidad/viento",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1370,
        "y": 2040,
        "wires": [
            [
                "254049d49ee1e06b",
                "c44145badfdd9d5b"
            ]
        ]
    },
    {
        "id": "254049d49ee1e06b",
        "type": "debug",
        "z": "e9891387af72915b",
        "d": true,
        "name": "recevied data from Hive MQ (SSL/TLS)",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1670,
        "y": 1980,
        "wires": []
    },
    {
        "id": "c717c2c2a952accb",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "d": true,
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1160,
        "y": 2040,
        "wires": []
    },
    {
        "id": "73a0f616d1b9a9d9",
        "type": "function",
        "z": "e9891387af72915b",
        "d": true,
        "name": "function 3",
        "func": "\nconst r = Math.random() * 100;\nlet value = msg.velocidad_viento ?? 40\nif(value > 100 || value < 5) {\n    value = 40\n}\nif (r <= 30 && value > 65) {\n    value -= 1\n} else if (r >= 90 && value < 100) {\n    value += 1\n}\nmsg.payload = {\"speed\": value}\nmsg.velocidad_viento = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 2040,
        "wires": [
            [
                "c717c2c2a952accb",
                "aea0ed4217d2ae56"
            ]
        ]
    },
    {
        "id": "c44145badfdd9d5b",
        "type": "change",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ev001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 2040,
        "wires": [
            [
                "1a2bd4a1abfdc495"
            ]
        ]
    },
    {
        "id": "1a2bd4a1abfdc495",
        "type": "http request",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 1790,
        "y": 2040,
        "wires": [
            [
                "0023156a988f15b1"
            ]
        ]
    },
    {
        "id": "316e3d3d90203958",
        "type": "json",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2090,
        "y": 2060,
        "wires": [
            [
                "ac2a8388b98ad589"
            ]
        ]
    },
    {
        "id": "ac2a8388b98ad589",
        "type": "debug",
        "z": "e9891387af72915b",
        "d": true,
        "name": "update devices",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2280,
        "y": 2040,
        "wires": []
    },
    {
        "id": "0023156a988f15b1",
        "type": "switch",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1950,
        "y": 2040,
        "wires": [
            [
                "ac2a8388b98ad589"
            ],
            [
                "316e3d3d90203958"
            ]
        ]
    },
    {
        "id": "aea0ed4217d2ae56",
        "type": "change",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "velocidad_viento",
                "pt": "flow",
                "to": "velocidad_viento",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 2120,
        "wires": [
            [
                "5c3bc1636077e0f3"
            ]
        ]
    },
    {
        "id": "5c3bc1636077e0f3",
        "type": "debug",
        "z": "e9891387af72915b",
        "d": true,
        "name": "debug 13",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 2120,
        "wires": []
    },
    {
        "id": "fe27f8344f808535",
        "type": "comment",
        "z": "e9891387af72915b",
        "d": true,
        "name": "Set Velocidad Viento Value",
        "info": "",
        "x": 810,
        "y": 2000,
        "wires": []
    },
    {
        "id": "89a54746b4346501",
        "type": "inject",
        "z": "e9891387af72915b",
        "name": "flow variables",
        "props": [
            {
                "p": "calidad_aire",
                "v": "95",
                "vt": "num"
            },
            {
                "p": "temp_bateria",
                "v": "25",
                "vt": "num"
            },
            {
                "p": "velocidad_viento",
                "v": "40",
                "vt": "num"
            },
            {
                "p": "calidad_agua",
                "v": "95",
                "vt": "num"
            },
            {
                "p": "capacidad_tanque",
                "v": "40",
                "vt": "num"
            },
            {
                "p": "alarm_state",
                "v": "false",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 270,
        "y": 1460,
        "wires": [
            [
                "594c440edad985ae"
            ]
        ]
    },
    {
        "id": "594c440edad985ae",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "calidad_aire",
                "pt": "flow",
                "to": "calidad_aire",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "calidad_agua",
                "pt": "flow",
                "to": "calidad_agua",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "velocidad_viento",
                "pt": "flow",
                "to": "velocidad_viento",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "capacidad_tanque",
                "pt": "flow",
                "to": "capacidad_tanque",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "alarm_state",
                "pt": "flow",
                "to": "alarm_state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 1460,
        "wires": [
            []
        ]
    },
    {
        "id": "cfd66b0b51f09e7a",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "hidraulico/calidad",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1350,
        "y": 2260,
        "wires": [
            [
                "e035ef7978404ba3",
                "c56d8640c1030a5d"
            ]
        ]
    },
    {
        "id": "e035ef7978404ba3",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "recevied data from Hive MQ (SSL/TLS)",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1650,
        "y": 2200,
        "wires": []
    },
    {
        "id": "e0e8654b97f5fd8c",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1140,
        "y": 2260,
        "wires": []
    },
    {
        "id": "1ebf1a16a725cd13",
        "type": "function",
        "z": "e9891387af72915b",
        "name": "function 11",
        "func": "\nconst r = Math.random() * 100;\nlet value = msg.calidad_agua ?? 95\nif(value < 70) {\n    value = 95\n}\nif (r <=20 && value > 65) {\n    value -= 1\n} else if (r >= 80 && value < 100) {\n    value += 1\n}\nmsg.payload = {\"quality\": value}\nmsg.calidad_agua = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 2260,
        "wires": [
            [
                "e0e8654b97f5fd8c",
                "2603faac19078b49"
            ]
        ]
    },
    {
        "id": "c56d8640c1030a5d",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hca001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1580,
        "y": 2260,
        "wires": [
            [
                "24d3d9f378202cc3"
            ]
        ]
    },
    {
        "id": "24d3d9f378202cc3",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 1770,
        "y": 2260,
        "wires": [
            [
                "7dc22ec80342ab54"
            ]
        ]
    },
    {
        "id": "c8cdd5d8a6de5bf2",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2070,
        "y": 2280,
        "wires": [
            [
                "7ec1f9dc26e7ce02"
            ]
        ]
    },
    {
        "id": "7ec1f9dc26e7ce02",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "update devices",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2260,
        "y": 2260,
        "wires": []
    },
    {
        "id": "7dc22ec80342ab54",
        "type": "switch",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1930,
        "y": 2260,
        "wires": [
            [
                "7ec1f9dc26e7ce02"
            ],
            [
                "c8cdd5d8a6de5bf2"
            ]
        ]
    },
    {
        "id": "2603faac19078b49",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "calidad_agua",
                "pt": "flow",
                "to": "calidad_agua",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1120,
        "y": 2340,
        "wires": [
            [
                "818962fecc0d5b9d"
            ]
        ]
    },
    {
        "id": "818962fecc0d5b9d",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 14",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1340,
        "y": 2340,
        "wires": []
    },
    {
        "id": "9310d5c22349692b",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Set Calidad Agua",
        "info": "",
        "x": 760,
        "y": 2220,
        "wires": []
    },
    {
        "id": "f81e128b5e3ec694",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "hidraulico/capacidad",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1370,
        "y": 2460,
        "wires": [
            [
                "d63e494e14c76e8a",
                "404a51720254a808"
            ]
        ]
    },
    {
        "id": "d63e494e14c76e8a",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "recevied data from Hive MQ (SSL/TLS)",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1670,
        "y": 2400,
        "wires": []
    },
    {
        "id": "54be4f316bf02718",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1160,
        "y": 2460,
        "wires": []
    },
    {
        "id": "99604eba2450621f",
        "type": "function",
        "z": "e9891387af72915b",
        "name": "function 12",
        "func": "\nconst r = Math.random() * 100;\nlet value = msg.capacidad_tanque ?? 40\nif(value > 100 || value < 5) {\n    value = 40\n}\nif (r <= 30 && value > 0) {\n    value -= 1\n} else if (r >= 90 && value < 100) {\n    value += 1\n}\nmsg.payload = {\"capacity\": value}\nmsg.capacidad_tanque = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 2460,
        "wires": [
            [
                "54be4f316bf02718",
                "c373f9010eac2c3f"
            ]
        ]
    },
    {
        "id": "404a51720254a808",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hct001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 2460,
        "wires": [
            [
                "1292b2f9f06996b1"
            ]
        ]
    },
    {
        "id": "1292b2f9f06996b1",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 1790,
        "y": 2460,
        "wires": [
            [
                "b7b782d98aae69e2"
            ]
        ]
    },
    {
        "id": "87498f49ff16da85",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2090,
        "y": 2480,
        "wires": [
            [
                "493943f8ec1875cf"
            ]
        ]
    },
    {
        "id": "493943f8ec1875cf",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "update devices",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2280,
        "y": 2460,
        "wires": []
    },
    {
        "id": "b7b782d98aae69e2",
        "type": "switch",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1950,
        "y": 2460,
        "wires": [
            [
                "493943f8ec1875cf"
            ],
            [
                "87498f49ff16da85"
            ]
        ]
    },
    {
        "id": "c373f9010eac2c3f",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "capacidad_tanque",
                "pt": "flow",
                "to": "capacidad_tanque",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 2540,
        "wires": [
            [
                "0bc32681fbef6e30"
            ]
        ]
    },
    {
        "id": "0bc32681fbef6e30",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 15",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 2540,
        "wires": []
    },
    {
        "id": "fa335cdad9909dc1",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Set Capacidad Tanque",
        "info": "",
        "x": 800,
        "y": 2420,
        "wires": []
    },
    {
        "id": "d37ea71f66621d2f",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "aislamiento/alarma",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1370,
        "y": 2660,
        "wires": [
            [
                "fc16ec7d1961460a",
                "5a19d7a177c6bc81"
            ]
        ]
    },
    {
        "id": "fc16ec7d1961460a",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "recevied data from Hive MQ (SSL/TLS)",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1670,
        "y": 2600,
        "wires": []
    },
    {
        "id": "ef9ca27c463beb8b",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "Hive MQ (SSL/TLS)",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1160,
        "y": 2660,
        "wires": []
    },
    {
        "id": "366027350853f6cd",
        "type": "function",
        "z": "e9891387af72915b",
        "name": "function 15",
        "func": "\nconst r = Math.random() * 1000;\nlet value = msg.alarm_state ?? false\nvalue = r > 995\nmsg.payload = {\"alarma\": value}\nmsg.alarm_state = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 2660,
        "wires": [
            [
                "ef9ca27c463beb8b",
                "bff32c44c74d6e0d"
            ]
        ]
    },
    {
        "id": "5a19d7a177c6bc81",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "as001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 2660,
        "wires": [
            [
                "9a7e30f86be0fe96"
            ]
        ]
    },
    {
        "id": "9a7e30f86be0fe96",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 1790,
        "y": 2660,
        "wires": [
            [
                "5a983824a425c74b"
            ]
        ]
    },
    {
        "id": "f1b527d325c96fc9",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2090,
        "y": 2680,
        "wires": [
            [
                "9111e75c12640c61"
            ]
        ]
    },
    {
        "id": "9111e75c12640c61",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "update devices",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2280,
        "y": 2660,
        "wires": []
    },
    {
        "id": "5a983824a425c74b",
        "type": "switch",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1950,
        "y": 2660,
        "wires": [
            [
                "9111e75c12640c61"
            ],
            [
                "f1b527d325c96fc9"
            ]
        ]
    },
    {
        "id": "bff32c44c74d6e0d",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "alarm_state",
                "pt": "flow",
                "to": "alarm_state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 2740,
        "wires": [
            [
                "a0f1816771d8e6e6"
            ]
        ]
    },
    {
        "id": "a0f1816771d8e6e6",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 2740,
        "wires": []
    },
    {
        "id": "a29b9901e6c2157f",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Set Alarma Incendios",
        "info": "",
        "x": 800,
        "y": 2620,
        "wires": []
    },
    {
        "id": "27c936b60b9b9a7c",
        "type": "inject",
        "z": "e9891387af72915b",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 1560,
        "wires": [
            [
                "1e1eb367295a99f1"
            ]
        ]
    },
    {
        "id": "cf561b878e90d0e3",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "calidad_aire",
                "pt": "msg",
                "to": "calidad_aire",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ventilacion/calidad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 1560,
        "wires": [
            [
                "aec29c4ea58a4058"
            ]
        ]
    },
    {
        "id": "5d38a22f98fc7f2b",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "temp_bateria",
                "pt": "msg",
                "to": "temp_bateria",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "electricidad/tbateria",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 1800,
        "wires": [
            [
                "81f33317742dbdc2"
            ]
        ]
    },
    {
        "id": "6c969d528008ea8e",
        "type": "change",
        "z": "e9891387af72915b",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "velocidad_viento",
                "pt": "msg",
                "to": "velocidad_viento",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "electricidad/viento",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 2040,
        "wires": [
            [
                "73a0f616d1b9a9d9"
            ]
        ]
    },
    {
        "id": "a92e0399b43f6d1d",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "calidad_agua",
                "pt": "msg",
                "to": "calidad_agua",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "hidraulico/calidad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 2260,
        "wires": [
            [
                "1ebf1a16a725cd13"
            ]
        ]
    },
    {
        "id": "1d4063890445fda8",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "capacidad_tanque",
                "pt": "msg",
                "to": "capacidad_tanque",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "hidraulico/capacidad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 2460,
        "wires": [
            [
                "99604eba2450621f"
            ]
        ]
    },
    {
        "id": "5c87a28d45b79226",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "alarm_state",
                "pt": "msg",
                "to": "alarm_state",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "aislamiento/alarma",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 2660,
        "wires": [
            [
                "366027350853f6cd"
            ]
        ]
    },
    {
        "id": "e84d5d3c30ddf3f8",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 660,
        "wires": [
            [
                "3d166ad6a0baed6d"
            ]
        ]
    },
    {
        "id": "602d835fb7f3d6b6",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 780,
        "wires": [
            [
                "b0ca9a4b96193de7"
            ]
        ]
    },
    {
        "id": "968b8545d7342635",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 900,
        "wires": [
            [
                "aee7e0c9640a795a"
            ]
        ]
    },
    {
        "id": "f9ea7ce93240999d",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "locked",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 1040,
        "wires": [
            [
                "e83c5a446c25b99e"
            ]
        ]
    },
    {
        "id": "26bcd4247084378e",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "locked",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 1180,
        "wires": [
            [
                "bea3c848e428a59a"
            ]
        ]
    },
    {
        "id": "72e6d0376acaabab",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "locked",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 1300,
        "wires": [
            [
                "28481ea6c3fae147"
            ]
        ]
    },
    {
        "id": "f8b55ccad178e1dd",
        "type": "inject",
        "z": "e9891387af72915b",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 120,
        "y": 660,
        "wires": [
            [
                "424e335d00fedb5b"
            ]
        ]
    },
    {
        "id": "f8080295aa7acb93",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "EL AGENTE IOT SE SUSCRIBE A LOS DATOS DE LOS ACTUADORES QUE EST√ÅN EN ORION",
        "info": "",
        "x": 920,
        "y": 560,
        "wires": []
    },
    {
        "id": "52eb97e84b95113f",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "REENVIA EL DATO POR MQTT AL DISPOSITIVO",
        "info": "",
        "x": 1750,
        "y": 560,
        "wires": []
    },
    {
        "id": "02339720cf602115",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "SIMULACI√ìN DE COMPORTAMIENTO DE LOS DISPOSITIVOS IOT",
        "info": "",
        "x": 270,
        "y": 1400,
        "wires": []
    },
    {
        "id": "2af49057da98ba77",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "SE ENVIA POR MQTT AL AGENTE IOT Y ESTE REENVIA A ORION",
        "info": "",
        "x": 1370,
        "y": 1440,
        "wires": []
    },
    {
        "id": "1e1eb367295a99f1",
        "type": "trigger",
        "z": "e9891387af72915b",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 300,
        "y": 1560,
        "wires": [
            [
                "cf561b878e90d0e3",
                "5d38a22f98fc7f2b",
                "6c969d528008ea8e",
                "a92e0399b43f6d1d",
                "1d4063890445fda8",
                "5c87a28d45b79226"
            ]
        ]
    },
    {
        "id": "424e335d00fedb5b",
        "type": "trigger",
        "z": "e9891387af72915b",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 320,
        "y": 660,
        "wires": [
            [
                "e84d5d3c30ddf3f8",
                "968b8545d7342635",
                "f9ea7ce93240999d",
                "26bcd4247084378e",
                "72e6d0376acaabab",
                "602d835fb7f3d6b6"
            ]
        ]
    },
    {
        "id": "9071db7e7fc4af05",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://my.meteoblue.com/packages/basic-1h_basic-day?lat=47.558&lon=7.573&apikey={{{apikey}}}https://my.meteoblue.com/packages/basic-1h_basic-day?lat=47.558&lon=7.573&apikey=oGUELBe36f07djyv",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1010,
        "y": 2880,
        "wires": [
            [
                "4dc6324e48708030"
            ]
        ]
    },
    {
        "id": "e93f0a5f2667a270",
        "type": "inject",
        "z": "e9891387af72915b",
        "name": "Valores URL API",
        "props": [
            {
                "p": "urla",
                "v": "my.meteoblue.com/packages/basic-1h_basic-day?lat=39.47391&lon=-0.37966&apikey=",
                "vt": "str"
            },
            {
                "p": "apikey",
                "v": "oGUELBe36f07djyv",
                "vt": "str"
            },
            {
                "p": "now",
                "v": "object",
                "vt": "date"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "windSpeedValue",
        "x": 560,
        "y": 2880,
        "wires": [
            [
                "4a2890749085b3b7"
            ]
        ]
    },
    {
        "id": "4dc6324e48708030",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1170,
        "y": 2880,
        "wires": [
            [
                "e25607d659c75314"
            ]
        ]
    },
    {
        "id": "4a2890749085b3b7",
        "type": "trigger",
        "z": "e9891387af72915b",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-15",
        "extend": false,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 790,
        "y": 2880,
        "wires": [
            [
                "9071db7e7fc4af05"
            ]
        ]
    },
    {
        "id": "e25607d659c75314",
        "type": "function",
        "z": "e9891387af72915b",
        "name": "Control Datos Tiempo",
        "func": "\n  const currentDate = msg.now; // Fecha y hora actual\n  const formattedCurrentDate = formatDateToMatch(currentDate); // Formatear la fecha para que coincida con el formato del objeto `time`\n\n  // Buscar el √≠ndice en el array `time` que coincida con la fecha y hora actual\n  const timeIndex = msg.payload.data_1h.time.findIndex(time => time === formattedCurrentDate);\n\n  var value;\n  if (timeIndex !== -1) {\n    value = msg.payload.data_1h.windspeed[timeIndex];\n    // Si se encuentra, devolver el `windspeed` correspondiente\n    console.log(\"Valor\", value);\n    msg.payload ={\"speed\":value} ;\n  }else{\n    console.log(\"Dato no encontrado\");\n  }\n\n  return msg;\n\n\n// Funci√≥n auxiliar para formatear la fecha actual al formato `YYYY-MM-DD HH:mm`\nfunction formatDateToMatch(date){\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0'); // Mes (0 indexado)\n  const day = String(date.getDate()).padStart(2, '0');\n  const hours = String(date.getHours()).padStart(2, '0'); // Hora en formato 24 horas\n  const minutes = '00'; // Siempre redondeamos al inicio de la hora\n\n  return `${year}-${month}-${day} ${hours}:${minutes}`;\n}",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1340,
        "y": 2880,
        "wires": [
            [
                "5483b3f6882cabc6",
                "6047b7dc1be81ab9"
            ]
        ]
    },
    {
        "id": "8072d4ab09c919f2",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "CONSULTAS APIS EXTERNAS",
        "info": "",
        "x": 590,
        "y": 2780,
        "wires": []
    },
    {
        "id": "6b55a3b792f78d78",
        "type": "comment",
        "z": "e9891387af72915b",
        "name": "Medici√≥n velocidad viento por API externa",
        "info": "",
        "x": 620,
        "y": 2840,
        "wires": []
    },
    {
        "id": "831c7416b209d76f",
        "type": "change",
        "z": "e9891387af72915b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ev001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 2880,
        "wires": [
            [
                "1753883f6bb737d7"
            ]
        ]
    },
    {
        "id": "1753883f6bb737d7",
        "type": "http request",
        "z": "e9891387af72915b",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2210,
        "y": 2880,
        "wires": [
            [
                "883cea2c688134df"
            ]
        ]
    },
    {
        "id": "f7930ffcfe587abe",
        "type": "json",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2470,
        "y": 2920,
        "wires": [
            [
                "964e1bb05db7fb33"
            ]
        ]
    },
    {
        "id": "964e1bb05db7fb33",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "update wind speed: StatusCode",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "statusCode",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2650,
        "y": 2880,
        "wires": []
    },
    {
        "id": "883cea2c688134df",
        "type": "switch",
        "z": "e9891387af72915b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2370,
        "y": 2880,
        "wires": [
            [
                "964e1bb05db7fb33"
            ],
            [
                "f7930ffcfe587abe"
            ]
        ]
    },
    {
        "id": "5483b3f6882cabc6",
        "type": "debug",
        "z": "e9891387af72915b",
        "name": "debug 24",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1560,
        "y": 2780,
        "wires": []
    },
    {
        "id": "0146367d7e4ebd1a",
        "type": "mqtt in",
        "z": "e9891387af72915b",
        "name": "windSpeedValue",
        "topic": "windSpeedValue",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1840,
        "y": 2880,
        "wires": [
            [
                "831c7416b209d76f"
            ]
        ]
    },
    {
        "id": "6047b7dc1be81ab9",
        "type": "mqtt out",
        "z": "e9891387af72915b",
        "name": "windSpeedValue",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1630,
        "y": 2880,
        "wires": []
    },
    {
        "id": "3418cd3335a0b93b",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Get Calidad Aire",
        "info": "",
        "x": 600,
        "y": 180,
        "wires": []
    },
    {
        "id": "4bb0d100f030ce4d",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 220,
        "wires": [
            [
                "f7200232f5c22fe3"
            ]
        ]
    },
    {
        "id": "f7200232f5c22fe3",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 220,
        "wires": [
            [
                "5924072e5be741b0",
                "08a2fe00eccfe4f8"
            ]
        ]
    },
    {
        "id": "875faf33c50bacb7",
        "type": "inject",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.20.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 140,
        "wires": [
            [
                "d1b32033fb4e25ea"
            ]
        ]
    },
    {
        "id": "d1b32033fb4e25ea",
        "type": "change",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "43e2998056e32459",
        "type": "ui_gauge",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "gage",
        "title": "Temperatura Bateria",
        "label": "C¬∫",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#f5c211",
            "#c01c28"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1200,
        "y": 340,
        "wires": []
    },
    {
        "id": "b6067b17ef910f86",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Get Temperatura Bateria ",
        "info": "",
        "x": 630,
        "y": 320,
        "wires": []
    },
    {
        "id": "52bf2d6754cc07e8",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 360,
        "wires": [
            [
                "e592dea56330d277"
            ]
        ]
    },
    {
        "id": "e592dea56330d277",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 360,
        "wires": [
            [
                "43e2998056e32459",
                "8f33aeb804d702bc"
            ]
        ]
    },
    {
        "id": "5924072e5be741b0",
        "type": "ui_gauge",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "gage",
        "title": "Calidad Aire",
        "label": "%",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#c01c28",
            "#e5a50a",
            "#26a269"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1230,
        "y": 200,
        "wires": []
    },
    {
        "id": "c40bec42e04e0e03",
        "type": "ui_switch",
        "z": "66697df425b4ad85",
        "name": "",
        "label": "Ventilador",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1460,
        "y": 860,
        "wires": [
            [
                "e0ac9d5a982679d4"
            ]
        ]
    },
    {
        "id": "22d7c38adb3fd815",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Ventilador Switch",
        "info": "",
        "x": 600,
        "y": 820,
        "wires": []
    },
    {
        "id": "73291a0a943daf79",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 860,
        "wires": [
            [
                "a46cb62b4105af1c"
            ]
        ]
    },
    {
        "id": "a46cb62b4105af1c",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 860,
        "wires": [
            [
                "4b8e02e49f0e573a"
            ]
        ]
    },
    {
        "id": "e0ac9d5a982679d4",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 4",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 860,
        "wires": [
            [
                "c6b308b6f8b62ccf",
                "a15ad516df4f7a8a"
            ]
        ]
    },
    {
        "id": "c6b308b6f8b62ccf",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 860,
        "wires": [
            [
                "14595e68ec1c38fd"
            ]
        ]
    },
    {
        "id": "14595e68ec1c38fd",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2010,
        "y": 860,
        "wires": [
            [
                "4abcb4a15c8c1229"
            ]
        ]
    },
    {
        "id": "aa14eadfd3c0e6fd",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2330,
        "y": 880,
        "wires": [
            [
                "57782702c6a41789"
            ]
        ]
    },
    {
        "id": "57782702c6a41789",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2520,
        "y": 860,
        "wires": []
    },
    {
        "id": "4abcb4a15c8c1229",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2190,
        "y": 860,
        "wires": [
            [
                "57782702c6a41789"
            ],
            [
                "aa14eadfd3c0e6fd"
            ]
        ]
    },
    {
        "id": "e27c0bce69e959e2",
        "type": "ui_switch",
        "z": "66697df425b4ad85",
        "name": "",
        "label": "Molino",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1450,
        "y": 980,
        "wires": [
            [
                "c2e69c04dbc41759"
            ]
        ]
    },
    {
        "id": "f97c8a756842bff8",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Molino Switch",
        "info": "",
        "x": 590,
        "y": 940,
        "wires": []
    },
    {
        "id": "7546cdd4c056ea85",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 980,
        "wires": [
            [
                "57e7fca69cef6ed4"
            ]
        ]
    },
    {
        "id": "57e7fca69cef6ed4",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 980,
        "wires": [
            [
                "fa077081ed0d810d"
            ]
        ]
    },
    {
        "id": "c2e69c04dbc41759",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 5",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 980,
        "wires": [
            [
                "616af5adb15fb5cb",
                "a1ffd78d8999a138"
            ]
        ]
    },
    {
        "id": "616af5adb15fb5cb",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 980,
        "wires": [
            [
                "d6c594937cb97476"
            ]
        ]
    },
    {
        "id": "d6c594937cb97476",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2010,
        "y": 980,
        "wires": [
            [
                "2cd51e3bb2e3013c"
            ]
        ]
    },
    {
        "id": "c0f4712f20d3f88e",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2330,
        "y": 1000,
        "wires": [
            [
                "0fbf9eec86b6b2b9"
            ]
        ]
    },
    {
        "id": "0fbf9eec86b6b2b9",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2520,
        "y": 980,
        "wires": []
    },
    {
        "id": "2cd51e3bb2e3013c",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2190,
        "y": 980,
        "wires": [
            [
                "0fbf9eec86b6b2b9"
            ],
            [
                "c0f4712f20d3f88e"
            ]
        ]
    },
    {
        "id": "e232dae6dbca59e1",
        "type": "ui_switch",
        "z": "66697df425b4ad85",
        "name": "",
        "label": "Bateria",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1460,
        "y": 1100,
        "wires": [
            [
                "5da7141ea85a6642"
            ]
        ]
    },
    {
        "id": "5af1201249258025",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Bateria Switch",
        "info": "",
        "x": 590,
        "y": 1060,
        "wires": []
    },
    {
        "id": "9176cf462b268ceb",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 1100,
        "wires": [
            [
                "4cf24103dd0db395"
            ]
        ]
    },
    {
        "id": "5da7141ea85a6642",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 6",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 1100,
        "wires": [
            [
                "ce43395ec89d0bd8"
            ]
        ]
    },
    {
        "id": "ce43395ec89d0bd8",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 1100,
        "wires": [
            [
                "0472221c97bc600a"
            ]
        ]
    },
    {
        "id": "0472221c97bc600a",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2010,
        "y": 1100,
        "wires": [
            [
                "683f19cd4d462b15"
            ]
        ]
    },
    {
        "id": "1b679f8bd696da2d",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2330,
        "y": 1120,
        "wires": [
            [
                "e0d17ced53dc9c35"
            ]
        ]
    },
    {
        "id": "e0d17ced53dc9c35",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2520,
        "y": 1100,
        "wires": []
    },
    {
        "id": "683f19cd4d462b15",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2190,
        "y": 1100,
        "wires": [
            [
                "e0d17ced53dc9c35"
            ],
            [
                "1b679f8bd696da2d"
            ]
        ]
    },
    {
        "id": "ee563c1ecbce1bd8",
        "type": "ui_gauge",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "compass",
        "title": "Velocidad Viento",
        "label": "m/s",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#f5c211",
            "#c01c28"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1210,
        "y": 460,
        "wires": []
    },
    {
        "id": "be8952c7e161cbaa",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Get Velocidad Viento ",
        "info": "",
        "x": 610,
        "y": 460,
        "wires": []
    },
    {
        "id": "693bf480b022193c",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 500,
        "wires": [
            [
                "c5380df3106caf6a"
            ]
        ]
    },
    {
        "id": "c5380df3106caf6a",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 500,
        "wires": [
            [
                "ee563c1ecbce1bd8",
                "4d25555246599fd1"
            ]
        ]
    },
    {
        "id": "5ab943cbff8f67a0",
        "type": "ui_switch",
        "z": "66697df425b4ad85",
        "name": "",
        "label": "Puerta Exterior",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1480,
        "y": 1220,
        "wires": [
            [
                "dca9827e580cb41e"
            ]
        ]
    },
    {
        "id": "9bdbd042739eb41a",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Puerta Exterior Switch",
        "info": "",
        "x": 620,
        "y": 1180,
        "wires": []
    },
    {
        "id": "dfad28025814241a",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 1220,
        "wires": [
            [
                "428070559bb13b97"
            ]
        ]
    },
    {
        "id": "dca9827e580cb41e",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 8",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 1220,
        "wires": [
            [
                "1f81158ee6cf2b67"
            ]
        ]
    },
    {
        "id": "1f81158ee6cf2b67",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 1220,
        "wires": [
            [
                "0358efc435f15715"
            ]
        ]
    },
    {
        "id": "0358efc435f15715",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2010,
        "y": 1220,
        "wires": [
            [
                "efffcda7319d3bfb"
            ]
        ]
    },
    {
        "id": "a76ff04b8be3b16a",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2330,
        "y": 1240,
        "wires": [
            [
                "91e9123bf87d38fb"
            ]
        ]
    },
    {
        "id": "91e9123bf87d38fb",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2520,
        "y": 1220,
        "wires": []
    },
    {
        "id": "efffcda7319d3bfb",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2190,
        "y": 1220,
        "wires": [
            [
                "91e9123bf87d38fb"
            ],
            [
                "a76ff04b8be3b16a"
            ]
        ]
    },
    {
        "id": "cde5f0cc2c0192a8",
        "type": "ui_switch",
        "z": "66697df425b4ad85",
        "name": "",
        "label": "Puerta Interior",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": false,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1480,
        "y": 1340,
        "wires": [
            [
                "0088a1176edd51b1"
            ]
        ]
    },
    {
        "id": "b424375371e883c3",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Compuerta Interior Switch",
        "info": "",
        "x": 630,
        "y": 1300,
        "wires": []
    },
    {
        "id": "b9726b56927dde5d",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 1340,
        "wires": [
            [
                "2a195b17c664b460"
            ]
        ]
    },
    {
        "id": "0088a1176edd51b1",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 9",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 1340,
        "wires": [
            [
                "61e9d53cdc6ddc7b"
            ]
        ]
    },
    {
        "id": "61e9d53cdc6ddc7b",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 1340,
        "wires": [
            [
                "b714a3a8ca27b75c"
            ]
        ]
    },
    {
        "id": "b714a3a8ca27b75c",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2010,
        "y": 1340,
        "wires": [
            [
                "c67040e8e141589f"
            ]
        ]
    },
    {
        "id": "55a58e0f0f91d178",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2330,
        "y": 1360,
        "wires": [
            [
                "2e34ac5d8005c041"
            ]
        ]
    },
    {
        "id": "2e34ac5d8005c041",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2520,
        "y": 1340,
        "wires": []
    },
    {
        "id": "c67040e8e141589f",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2190,
        "y": 1340,
        "wires": [
            [
                "2e34ac5d8005c041"
            ],
            [
                "55a58e0f0f91d178"
            ]
        ]
    },
    {
        "id": "cec47b9eda3c1ddb",
        "type": "ui_switch",
        "z": "66697df425b4ad85",
        "name": "",
        "label": "Compuertas Agua",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1490,
        "y": 1460,
        "wires": [
            [
                "f003271d84030ffe"
            ]
        ]
    },
    {
        "id": "499e6489699b7923",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Compuertas Hidraulicas Switch",
        "info": "",
        "x": 650,
        "y": 1420,
        "wires": []
    },
    {
        "id": "64df86971052549b",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 1460,
        "wires": [
            [
                "a3a0af7e1b2c51f7"
            ]
        ]
    },
    {
        "id": "a3a0af7e1b2c51f7",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 1460,
        "wires": [
            [
                "a56ad40f3a32b894"
            ]
        ]
    },
    {
        "id": "f003271d84030ffe",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 10",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1690,
        "y": 1460,
        "wires": [
            [
                "9afc3e131cadc7dd",
                "d2aac37a35bdbe56"
            ]
        ]
    },
    {
        "id": "9afc3e131cadc7dd",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1870,
        "y": 1460,
        "wires": [
            [
                "4e61613bdeba8878"
            ]
        ]
    },
    {
        "id": "4e61613bdeba8878",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2060,
        "y": 1460,
        "wires": [
            [
                "154394f09f857ec6"
            ]
        ]
    },
    {
        "id": "64089dd5f71878dc",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2380,
        "y": 1480,
        "wires": [
            [
                "e019657e42307be2"
            ]
        ]
    },
    {
        "id": "e019657e42307be2",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2570,
        "y": 1460,
        "wires": []
    },
    {
        "id": "154394f09f857ec6",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2240,
        "y": 1460,
        "wires": [
            [
                "e019657e42307be2"
            ],
            [
                "64089dd5f71878dc"
            ]
        ]
    },
    {
        "id": "5b1497d734e3a1c7",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Get Calidad Agua",
        "info": "",
        "x": 600,
        "y": 580,
        "wires": []
    },
    {
        "id": "ce7f67daba977823",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 620,
        "wires": [
            [
                "fdf4cbb3c0a2e08e"
            ]
        ]
    },
    {
        "id": "fdf4cbb3c0a2e08e",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 620,
        "wires": [
            [
                "81be511c3a4b4960"
            ]
        ]
    },
    {
        "id": "81be511c3a4b4960",
        "type": "ui_gauge",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "gage",
        "title": "Calidad Agua",
        "label": "%",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#c01c28",
            "#e5a50a",
            "#26a269"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1220,
        "y": 560,
        "wires": []
    },
    {
        "id": "12e31d74a88e3a92",
        "type": "ui_gauge",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "12",
        "gtype": "wave",
        "title": "Capacidad Tanque",
        "label": "%",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#f5c211",
            "#c01c28"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1210,
        "y": 700,
        "wires": []
    },
    {
        "id": "d76e53f5f98a8330",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Get Capacidad Tanque ",
        "info": "",
        "x": 620,
        "y": 700,
        "wires": []
    },
    {
        "id": "94c01c2184b26716",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 740,
        "wires": [
            [
                "79533d280611e608"
            ]
        ]
    },
    {
        "id": "79533d280611e608",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 740,
        "wires": [
            [
                "12e31d74a88e3a92",
                "99d75a43d73fb551"
            ]
        ]
    },
    {
        "id": "4cf24103dd0db395",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 1100,
        "wires": [
            [
                "73b4443d5ec27402"
            ]
        ]
    },
    {
        "id": "428070559bb13b97",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 1220,
        "wires": [
            [
                "482474ec42e8fcae"
            ]
        ]
    },
    {
        "id": "2a195b17c664b460",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 1340,
        "wires": [
            [
                "e73387efa0d9b613"
            ]
        ]
    },
    {
        "id": "482474ec42e8fcae",
        "type": "ui_text",
        "z": "66697df425b4ad85",
        "group": "95bc0ee9d93efab4",
        "order": 13,
        "width": "8",
        "height": "1",
        "name": "",
        "label": "Puerta Exterior",
        "format": "{{msg.payload.value ? \"Cerrada\" : \"Abierta\"}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 1220,
        "wires": []
    },
    {
        "id": "e73387efa0d9b613",
        "type": "ui_text",
        "z": "66697df425b4ad85",
        "group": "95bc0ee9d93efab4",
        "order": 13,
        "width": "8",
        "height": "1",
        "name": "",
        "label": "Puerta Interior",
        "format": "{{msg.payload.value ? \"Cerrada\" : \"Abierta\"}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 1340,
        "wires": []
    },
    {
        "id": "73b4443d5ec27402",
        "type": "ui_text",
        "z": "66697df425b4ad85",
        "group": "95bc0ee9d93efab4",
        "order": 13,
        "width": "8",
        "height": "1",
        "name": "",
        "label": "Estado Bateria",
        "format": "{{msg.payload.value ? \"Activo\" : \"Inactivo\"}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1230,
        "y": 1100,
        "wires": []
    },
    {
        "id": "4b8e02e49f0e573a",
        "type": "ui_text",
        "z": "66697df425b4ad85",
        "group": "95bc0ee9d93efab4",
        "order": 13,
        "width": "8",
        "height": "1",
        "name": "",
        "label": "Estado Ventilador",
        "format": "{{msg.payload.value ? \"Activo\" : \"Inactivo\"}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 860,
        "wires": []
    },
    {
        "id": "fa077081ed0d810d",
        "type": "ui_text",
        "z": "66697df425b4ad85",
        "group": "95bc0ee9d93efab4",
        "order": 13,
        "width": "8",
        "height": "1",
        "name": "",
        "label": "Estado Molino",
        "format": "{{msg.payload.value ? \"Activo\" : \"Inactivo\"}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1230,
        "y": 980,
        "wires": []
    },
    {
        "id": "a56ad40f3a32b894",
        "type": "ui_text",
        "z": "66697df425b4ad85",
        "group": "95bc0ee9d93efab4",
        "order": 13,
        "width": "8",
        "height": "1",
        "name": "",
        "label": "Estado Compuertas Agua",
        "format": "{{msg.payload.value ? \"Cerrada\" : \"Abierta\"}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1200,
        "y": 1460,
        "wires": []
    },
    {
        "id": "5b5d994f65a76f1a",
        "type": "ui_audio",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "voice": "urn:moz-tts:speechd:Spanish%20(Latin%20America)+David?es-419",
        "always": true,
        "x": 1780,
        "y": 1660,
        "wires": []
    },
    {
        "id": "9f1e79a2c5f11866",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1330,
        "y": 1580,
        "wires": [
            [
                "9888c46d3c3821a5"
            ]
        ]
    },
    {
        "id": "9888c46d3c3821a5",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Alerta, Alerta, se est√° produciendo un incendio. Repito, incendio. Evacuen inmediatamente.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1520,
        "y": 1580,
        "wires": [
            [
                "5b5d994f65a76f1a",
                "74c7d620cc6f9697"
            ]
        ]
    },
    {
        "id": "d34dfd85d22a1f93",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "Alerta Alarma Incendio",
        "info": "",
        "x": 620,
        "y": 1540,
        "wires": []
    },
    {
        "id": "40cf62c2aa88afa4",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 1580,
        "wires": [
            [
                "b3181ad2ba3cb2d5"
            ]
        ]
    },
    {
        "id": "b3181ad2ba3cb2d5",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1010,
        "y": 1580,
        "wires": [
            [
                "a33f8ad067826ff9"
            ]
        ]
    },
    {
        "id": "a33f8ad067826ff9",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 7",
        "func": "msg.payload = msg.payload.value\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1160,
        "y": 1580,
        "wires": [
            [
                "9f1e79a2c5f11866"
            ]
        ]
    },
    {
        "id": "736b6b2279e18321",
        "type": "ui_button",
        "z": "66697df425b4ad85",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 18,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Activar Alarma Incendio",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 1270,
        "y": 1700,
        "wires": [
            [
                "9888c46d3c3821a5"
            ]
        ]
    },
    {
        "id": "ad72db13a66233d8",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Calidad:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "quality",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 220,
        "wires": [
            [
                "4bb0d100f030ce4d"
            ]
        ]
    },
    {
        "id": "5690a14ee01e90fa",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:TBateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "temp",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 360,
        "wires": [
            [
                "52bf2d6754cc07e8"
            ]
        ]
    },
    {
        "id": "acb075e439e0a122",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Viento:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "speed",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 500,
        "wires": [
            [
                "693bf480b022193c"
            ]
        ]
    },
    {
        "id": "46a2c4d326741164",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:CalidadAgua:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "quality",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 620,
        "wires": [
            [
                "ce7f67daba977823"
            ]
        ]
    },
    {
        "id": "d3118caa1b9dc65b",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:CapacidadTanque:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "capacity",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 740,
        "wires": [
            [
                "94c01c2184b26716"
            ]
        ]
    },
    {
        "id": "a1cd6c519d1f4ceb",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 860,
        "wires": [
            [
                "73291a0a943daf79"
            ]
        ]
    },
    {
        "id": "7de388dd69877261",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 980,
        "wires": [
            [
                "7546cdd4c056ea85"
            ]
        ]
    },
    {
        "id": "244b64a358d2df93",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 1100,
        "wires": [
            [
                "9176cf462b268ceb"
            ]
        ]
    },
    {
        "id": "b8a1d1b6089f4b3c",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "locked",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 1220,
        "wires": [
            [
                "dfad28025814241a"
            ]
        ]
    },
    {
        "id": "b2681c5a6f090a7b",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "locked",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 1340,
        "wires": [
            [
                "b9726b56927dde5d"
            ]
        ]
    },
    {
        "id": "3e618ec3c0f1f49d",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "locked",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 1460,
        "wires": [
            [
                "64df86971052549b"
            ]
        ]
    },
    {
        "id": "aa59c4bdc685138b",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:SIncendios:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "attr",
                "pt": "msg",
                "to": "alarm",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 1580,
        "wires": [
            [
                "40cf62c2aa88afa4"
            ]
        ]
    },
    {
        "id": "5e5474029a09d273",
        "type": "inject",
        "z": "66697df425b4ad85",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 220,
        "wires": [
            [
                "75e2184f599695a6"
            ]
        ]
    },
    {
        "id": "0cdd68c925a02827",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "SUSCRIPCI√ìN DE LOS DATOS DE ORION PARA MONITORIZAR LOS DISPOSITIVOS DESDE LA APP",
        "info": "",
        "x": 1060,
        "y": 140,
        "wires": []
    },
    {
        "id": "7b2db17909ae7680",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "MODIFICACI√ìN MANUAL DE LOS VALORES DE LOS ACTUADORES",
        "info": "",
        "x": 1650,
        "y": 820,
        "wires": []
    },
    {
        "id": "194c3bec997eec7b",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Automatizacion Molino",
        "info": "",
        "x": 440,
        "y": 1760,
        "wires": []
    },
    {
        "id": "ce71c5a083b434cb",
        "type": "inject",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "subscription data",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "switch",
                "v": "1",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:Viento:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "speed",
                "vt": "str"
            },
            {
                "p": "molino",
                "v": "true",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "subscriptionWindSpeed",
        "payload": "{\"description\":\"Suscripci√≥n a cambios del dispositivo lamp001\",\"subject\":{\"entities\":[{\"id\":\"urn:ngsi-ld:Lamp:001\",\"type\":\"Thing\"}],\"condition\":{\"attrs\":[\"on\"]}},\"notification\":{\"httpCustom\":{\"url\":\"https://node-red:1880/notify\"},\"attrs\":[\"on\"]},\"expires\":\"2025-01-21T12:00:00.00Z\",\"throttling\":5}",
        "payloadType": "json",
        "x": 440,
        "y": 1980,
        "wires": [
            [
                "e8f6ebe499702e89"
            ]
        ]
    },
    {
        "id": "e8f6ebe499702e89",
        "type": "trigger",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 640,
        "y": 1980,
        "wires": [
            [
                "9f49eeb8fd591f85"
            ]
        ]
    },
    {
        "id": "b56e977177567ff0",
        "type": "json",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 990,
        "y": 1980,
        "wires": [
            []
        ]
    },
    {
        "id": "9f49eeb8fd591f85",
        "type": "http request",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 830,
        "y": 1980,
        "wires": [
            [
                "b56e977177567ff0"
            ]
        ]
    },
    {
        "id": "0c64912bd9172485",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Suscripcion Velocidad Viento",
        "info": "",
        "x": 460,
        "y": 1940,
        "wires": []
    },
    {
        "id": "cd042520a27d79df",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Actualizar cambios de molino a orion",
        "info": "",
        "x": 480,
        "y": 2040,
        "wires": []
    },
    {
        "id": "b86e39c4989c76a2",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Molino",
        "info": "",
        "x": 390,
        "y": 1820,
        "wires": []
    },
    {
        "id": "d656c32c82cc96dd",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Agente",
        "info": "",
        "x": 390,
        "y": 1880,
        "wires": []
    },
    {
        "id": "f71c9cf741694447",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Automatizacion Bateria",
        "info": "",
        "x": 400,
        "y": 2120,
        "wires": []
    },
    {
        "id": "ac87d11301e327c6",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Bateria",
        "info": "",
        "x": 350,
        "y": 2180,
        "wires": []
    },
    {
        "id": "e6cd6e03f569efcb",
        "type": "inject",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "subscription data",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "switch",
                "v": "1",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:TBateria:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "temp",
                "vt": "str"
            },
            {
                "p": "molino",
                "v": "true",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "subscriptionWindSpeed",
        "payload": "{\"description\":\"Suscripci√≥n a cambios del dispositivo lamp001\",\"subject\":{\"entities\":[{\"id\":\"urn:ngsi-ld:Lamp:001\",\"type\":\"Thing\"}],\"condition\":{\"attrs\":[\"on\"]}},\"notification\":{\"httpCustom\":{\"url\":\"https://node-red:1880/notify\"},\"attrs\":[\"on\"]},\"expires\":\"2025-01-21T12:00:00.00Z\",\"throttling\":5}",
        "payloadType": "json",
        "x": 440,
        "y": 2320,
        "wires": [
            [
                "22b7498cd548e1da"
            ]
        ]
    },
    {
        "id": "22b7498cd548e1da",
        "type": "trigger",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 660,
        "y": 2320,
        "wires": [
            [
                "dfca24f766c5ec58"
            ]
        ]
    },
    {
        "id": "fc3cc639e0705760",
        "type": "json",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1050,
        "y": 2320,
        "wires": [
            []
        ]
    },
    {
        "id": "dfca24f766c5ec58",
        "type": "http request",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 870,
        "y": 2320,
        "wires": [
            [
                "fc3cc639e0705760"
            ]
        ]
    },
    {
        "id": "bf8961a73dd21eb8",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Suscripcion Temperatura Bateria",
        "info": "",
        "x": 470,
        "y": 2280,
        "wires": []
    },
    {
        "id": "c418c7c170014b56",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Actuador",
        "info": "",
        "x": 400,
        "y": 2220,
        "wires": []
    },
    {
        "id": "f4873a8094acfb4f",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Automatizacion Ventiladores",
        "info": "",
        "x": 420,
        "y": 2400,
        "wires": []
    },
    {
        "id": "b1781831860b5653",
        "type": "inject",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "subscription data",
        "props": [
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:Calidad:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "quality",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 440,
        "y": 2620,
        "wires": [
            [
                "21ace1b6c29a5a3f"
            ]
        ]
    },
    {
        "id": "21ace1b6c29a5a3f",
        "type": "trigger",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 640,
        "y": 2620,
        "wires": [
            [
                "2142e86d2cdeb129"
            ]
        ]
    },
    {
        "id": "0bf92b0aaaee8291",
        "type": "json",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 990,
        "y": 2620,
        "wires": [
            []
        ]
    },
    {
        "id": "2142e86d2cdeb129",
        "type": "http request",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 830,
        "y": 2620,
        "wires": [
            [
                "0bf92b0aaaee8291"
            ]
        ]
    },
    {
        "id": "6467e4d7cf1e804b",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Suscripcion Calidad Aire",
        "info": "",
        "x": 450,
        "y": 2580,
        "wires": []
    },
    {
        "id": "89c0f1bb88ccd60b",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Actualizar cambios de molino a orion",
        "info": "",
        "x": 480,
        "y": 2680,
        "wires": []
    },
    {
        "id": "35f96a2d0b20544a",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Ventilador",
        "info": "",
        "x": 360,
        "y": 2460,
        "wires": []
    },
    {
        "id": "b19432b379e675ea",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Actuador",
        "info": "",
        "x": 400,
        "y": 2520,
        "wires": []
    },
    {
        "id": "d6a8f066bfda74bf",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Actuador",
        "info": "",
        "x": 400,
        "y": 2840,
        "wires": []
    },
    {
        "id": "ce572e6047f94f37",
        "type": "inject",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "subscription data",
        "props": [
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:CapacidadTanque:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "capacity",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 440,
        "y": 2940,
        "wires": [
            [
                "b4922ed0da6c5fbb"
            ]
        ]
    },
    {
        "id": "b4922ed0da6c5fbb",
        "type": "trigger",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 640,
        "y": 2940,
        "wires": [
            [
                "567e6ba58267b014"
            ]
        ]
    },
    {
        "id": "4ec54a407c114fb1",
        "type": "json",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 990,
        "y": 2940,
        "wires": [
            []
        ]
    },
    {
        "id": "567e6ba58267b014",
        "type": "http request",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 830,
        "y": 2940,
        "wires": [
            [
                "4ec54a407c114fb1"
            ]
        ]
    },
    {
        "id": "cb500fb8f870f258",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Suscripcion Cantidad Tanque",
        "info": "",
        "x": 460,
        "y": 2900,
        "wires": []
    },
    {
        "id": "17de073f30b61ac8",
        "type": "comment",
        "z": "66697df425b4ad85",
        "d": true,
        "name": "Automatizacion Compuertas agua",
        "info": "",
        "x": 440,
        "y": 2780,
        "wires": []
    },
    {
        "id": "d5931ec6b9ee1388",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 23",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": true\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2010,
        "y": 1580,
        "wires": [
            [
                "052c21b9c2ce23ed"
            ]
        ]
    },
    {
        "id": "052c21b9c2ce23ed",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2190,
        "y": 1580,
        "wires": [
            [
                "7af626c58ab7e72c"
            ]
        ]
    },
    {
        "id": "7af626c58ab7e72c",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2380,
        "y": 1580,
        "wires": [
            [
                "7144beb4aab50871"
            ]
        ]
    },
    {
        "id": "bfe090a57039cd12",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2700,
        "y": 1600,
        "wires": [
            [
                "0e05b60acf862339"
            ]
        ]
    },
    {
        "id": "0e05b60acf862339",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2890,
        "y": 1580,
        "wires": []
    },
    {
        "id": "7144beb4aab50871",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2560,
        "y": 1580,
        "wires": [
            [
                "0e05b60acf862339"
            ],
            [
                "bfe090a57039cd12"
            ]
        ]
    },
    {
        "id": "fe7ea795ddde7c33",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 24",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": true\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2010,
        "y": 1660,
        "wires": [
            [
                "9c90cd72518861e6"
            ]
        ]
    },
    {
        "id": "9c90cd72518861e6",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2190,
        "y": 1660,
        "wires": [
            [
                "6b8b1cf74e7baa55"
            ]
        ]
    },
    {
        "id": "6b8b1cf74e7baa55",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2380,
        "y": 1660,
        "wires": [
            [
                "bcedeaf2e40a3ba1"
            ]
        ]
    },
    {
        "id": "75b8e55aaafa221d",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2700,
        "y": 1680,
        "wires": [
            [
                "e5d7f76ecaaa7dba"
            ]
        ]
    },
    {
        "id": "e5d7f76ecaaa7dba",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2890,
        "y": 1660,
        "wires": []
    },
    {
        "id": "bcedeaf2e40a3ba1",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2560,
        "y": 1660,
        "wires": [
            [
                "e5d7f76ecaaa7dba"
            ],
            [
                "75b8e55aaafa221d"
            ]
        ]
    },
    {
        "id": "a139c2a191301343",
        "type": "comment",
        "z": "66697df425b4ad85",
        "name": "AUTOMATIZACION CIERRE COMPUERTAS INCENDIO",
        "info": "",
        "x": 1950,
        "y": 1540,
        "wires": []
    },
    {
        "id": "4d25555246599fd1",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "Control Vel Molino",
        "func": "if(msg.payload.value > 3 && msg.payload.value <45){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1490,
        "y": 500,
        "wires": [
            [
                "a1f95966407fac53"
            ]
        ]
    },
    {
        "id": "a1f95966407fac53",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "molino_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "molino_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1670,
        "y": 500,
        "wires": [
            [],
            [
                "a9221affaeb4b9c0",
                "879c56eb9de4f810"
            ]
        ]
    },
    {
        "id": "a9221affaeb4b9c0",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "molino_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1900,
        "y": 480,
        "wires": [
            [
                "83fb5068e2a65e09"
            ]
        ]
    },
    {
        "id": "83fb5068e2a65e09",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2140,
        "y": 480,
        "wires": []
    },
    {
        "id": "879c56eb9de4f810",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 19",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1850,
        "y": 540,
        "wires": [
            [
                "0522b88b576a7633"
            ]
        ]
    },
    {
        "id": "0522b88b576a7633",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2040,
        "y": 540,
        "wires": [
            [
                "318902e9c2462796"
            ]
        ]
    },
    {
        "id": "318902e9c2462796",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2230,
        "y": 540,
        "wires": [
            [
                "571538a047960f34"
            ]
        ]
    },
    {
        "id": "81854c5282a88323",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2530,
        "y": 560,
        "wires": [
            [
                "5804df667f100989"
            ]
        ]
    },
    {
        "id": "5804df667f100989",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2720,
        "y": 540,
        "wires": []
    },
    {
        "id": "571538a047960f34",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2390,
        "y": 540,
        "wires": [
            [
                "5804df667f100989"
            ],
            [
                "81854c5282a88323"
            ]
        ]
    },
    {
        "id": "08a2fe00eccfe4f8",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "Control Calidad Aire",
        "func": "if(msg.payload.value <50){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 220,
        "wires": [
            [
                "b3a61675f6b4260a"
            ]
        ]
    },
    {
        "id": "b3a61675f6b4260a",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "ventilador_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "ventilador_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1690,
        "y": 220,
        "wires": [
            [],
            [
                "4153583a94ddd6bf",
                "799588489317a5d8"
            ]
        ]
    },
    {
        "id": "4153583a94ddd6bf",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ventilador_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1950,
        "y": 120,
        "wires": [
            [
                "08599bf9d8ff0fdb"
            ]
        ]
    },
    {
        "id": "08599bf9d8ff0fdb",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 12",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2200,
        "y": 120,
        "wires": []
    },
    {
        "id": "799588489317a5d8",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 21",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1910,
        "y": 220,
        "wires": [
            [
                "e37d7a8a5b764f3b"
            ]
        ]
    },
    {
        "id": "e37d7a8a5b764f3b",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2080,
        "y": 220,
        "wires": [
            [
                "6875c83cb265fde6",
                "fcfc63c57b771fb8"
            ]
        ]
    },
    {
        "id": "6875c83cb265fde6",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2270,
        "y": 220,
        "wires": [
            [
                "745a49f45c6a39dc"
            ]
        ]
    },
    {
        "id": "3b8952a6842cfced",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2780,
        "y": 220,
        "wires": []
    },
    {
        "id": "745a49f45c6a39dc",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2450,
        "y": 220,
        "wires": [
            [
                "3b8952a6842cfced"
            ],
            [
                "8f4e3103affd6194"
            ]
        ]
    },
    {
        "id": "8f4e3103affd6194",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2590,
        "y": 240,
        "wires": [
            [
                "3b8952a6842cfced"
            ]
        ]
    },
    {
        "id": "fcfc63c57b771fb8",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 13",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2390,
        "y": 260,
        "wires": []
    },
    {
        "id": "8f33aeb804d702bc",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "Control Temp Bater√≠a",
        "func": "if(msg.payload.value < 50){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 360,
        "wires": [
            [
                "a9f2e36a29c036df"
            ]
        ]
    },
    {
        "id": "a9f2e36a29c036df",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "bateria_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "bateria_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1730,
        "y": 360,
        "wires": [
            [],
            [
                "152e3e59a360fc57",
                "0ab5851d68e29072"
            ]
        ]
    },
    {
        "id": "152e3e59a360fc57",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bateria_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1960,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "0ab5851d68e29072",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 20",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1910,
        "y": 380,
        "wires": [
            [
                "7969cbf96ca0c4da"
            ]
        ]
    },
    {
        "id": "7969cbf96ca0c4da",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2090,
        "y": 380,
        "wires": [
            [
                "fe8dddb4aef81d60"
            ]
        ]
    },
    {
        "id": "fe8dddb4aef81d60",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2280,
        "y": 380,
        "wires": [
            [
                "6aefcb4f2d853c34"
            ]
        ]
    },
    {
        "id": "3a377bdb2014eba9",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2600,
        "y": 400,
        "wires": [
            [
                "9470f9ef18c1f12f"
            ]
        ]
    },
    {
        "id": "9470f9ef18c1f12f",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2790,
        "y": 380,
        "wires": []
    },
    {
        "id": "6aefcb4f2d853c34",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2460,
        "y": 380,
        "wires": [
            [
                "9470f9ef18c1f12f"
            ],
            [
                "3a377bdb2014eba9"
            ]
        ]
    },
    {
        "id": "8c32a8a1a4e7d031",
        "type": "json",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2810,
        "y": 760,
        "wires": [
            [
                "c5129719cf0f1a81"
            ]
        ]
    },
    {
        "id": "3b39652197bd7fd6",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2670,
        "y": 740,
        "wires": [
            [
                "c5129719cf0f1a81"
            ],
            [
                "8c32a8a1a4e7d031"
            ]
        ]
    },
    {
        "id": "c5129719cf0f1a81",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 3000,
        "y": 740,
        "wires": []
    },
    {
        "id": "74c7d620cc6f9697",
        "type": "delay",
        "z": "66697df425b4ad85",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1780,
        "y": 1580,
        "wires": [
            [
                "d5931ec6b9ee1388",
                "fe7ea795ddde7c33"
            ]
        ]
    },
    {
        "id": "75e2184f599695a6",
        "type": "trigger",
        "z": "66697df425b4ad85",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 320,
        "y": 220,
        "wires": [
            [
                "ad72db13a66233d8",
                "5690a14ee01e90fa",
                "acb075e439e0a122",
                "46a2c4d326741164",
                "d3118caa1b9dc65b",
                "a1cd6c519d1f4ceb",
                "7de388dd69877261",
                "244b64a358d2df93",
                "b8a1d1b6089f4b3c",
                "b2681c5a6f090a7b",
                "3e618ec3c0f1f49d",
                "aa59c4bdc685138b"
            ]
        ]
    },
    {
        "id": "54f62f06577449d0",
        "type": "inject",
        "z": "66697df425b4ad85",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 60,
        "wires": [
            [
                "b72b3d243141722f"
            ]
        ]
    },
    {
        "id": "b72b3d243141722f",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "molino_prev_state",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "bateria_prev_state",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "ventilador_prev_state",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "a1ffd78d8999a138",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "molino_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1860,
        "y": 1020,
        "wires": [
            [
                "4bb2634104f2a2f2"
            ]
        ]
    },
    {
        "id": "4bb2634104f2a2f2",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 26",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2100,
        "y": 1020,
        "wires": []
    },
    {
        "id": "a15ad516df4f7a8a",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ventilador_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1870,
        "y": 900,
        "wires": [
            [
                "491e9ae94999f4a0"
            ]
        ]
    },
    {
        "id": "491e9ae94999f4a0",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 27",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2120,
        "y": 900,
        "wires": []
    },
    {
        "id": "d2aac37a35bdbe56",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1930,
        "y": 1420,
        "wires": [
            [
                "0a4b7230aaecb834"
            ]
        ]
    },
    {
        "id": "0a4b7230aaecb834",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 28",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2180,
        "y": 1420,
        "wires": []
    },
    {
        "id": "369bbe8076766f1a",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "Control Cantidad Agua",
        "func": "if(msg.payload.value <25){\n    msg.payload = false;\n} else if (msg.payload.value > 95) {\n    msg.payload = true;\n}\nelse msg.payload = msg.compuerta_prev_state\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1740,
        "y": 740,
        "wires": [
            [
                "c69c70b184db5922"
            ]
        ]
    },
    {
        "id": "c69c70b184db5922",
        "type": "switch",
        "z": "66697df425b4ad85",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "compuerta_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "compuerta_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1910,
        "y": 740,
        "wires": [
            [],
            [
                "fe1586cd585bde85",
                "354a3dc29b7743f1"
            ]
        ]
    },
    {
        "id": "fe1586cd585bde85",
        "type": "function",
        "z": "66697df425b4ad85",
        "name": "function 22",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2090,
        "y": 740,
        "wires": [
            [
                "8deef53a9d79955c"
            ]
        ]
    },
    {
        "id": "8deef53a9d79955c",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2300,
        "y": 740,
        "wires": [
            [
                "f824565e3443888d"
            ]
        ]
    },
    {
        "id": "f824565e3443888d",
        "type": "http request",
        "z": "66697df425b4ad85",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2490,
        "y": 740,
        "wires": [
            [
                "3b39652197bd7fd6"
            ]
        ]
    },
    {
        "id": "99d75a43d73fb551",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "msg",
                "to": "compuerta_prev_state",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 740,
        "wires": [
            [
                "369bbe8076766f1a"
            ]
        ]
    },
    {
        "id": "354a3dc29b7743f1",
        "type": "change",
        "z": "66697df425b4ad85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2170,
        "y": 660,
        "wires": [
            [
                "99050c60279f7a38"
            ]
        ]
    },
    {
        "id": "99050c60279f7a38",
        "type": "debug",
        "z": "66697df425b4ad85",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2380,
        "y": 660,
        "wires": []
    },
    {
        "id": "3ab60d2c06b8e624",
        "type": "inject",
        "z": "566d3f2244bf2252",
        "name": "flow variables",
        "props": [
            {
                "p": "keyrock_ip",
                "v": "192.168.40.10",
                "vt": "str"
            },
            {
                "p": "keyrock_puerto",
                "v": "3443",
                "vt": "str"
            },
            {
                "p": "keyrock_oauth2_client_id",
                "v": "d6ef7f8c-7c70-4b59-8e3d-121bcd316d47",
                "vt": "str"
            },
            {
                "p": "keyrock_oauth2_client_secret",
                "v": "79f7a7b3-fe5c-47c5-a3e5-c69592e2a47a",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 60,
        "wires": [
            [
                "dfb8e46c6aae83b0"
            ]
        ]
    },
    {
        "id": "dfb8e46c6aae83b0",
        "type": "change",
        "z": "566d3f2244bf2252",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "keyrock_ip",
                "pt": "flow",
                "to": "keyrock_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "keyrock_puerto",
                "pt": "flow",
                "to": "keyrock_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "keyrock_oauth2_client_id",
                "pt": "flow",
                "to": "keyrock_oauth2_client_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "keyrock_oauth2_client_secret",
                "pt": "flow",
                "to": "keyrock_oauth2_client_secret",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "7fafe1dfb3885322",
        "type": "comment",
        "z": "566d3f2244bf2252",
        "name": "OAuth2 Token",
        "info": "",
        "x": 130,
        "y": 140,
        "wires": []
    },
    {
        "id": "280feba411e11507",
        "type": "comment",
        "z": "566d3f2244bf2252",
        "name": "Get OAuth2 token",
        "info": "",
        "x": 190,
        "y": 180,
        "wires": []
    },
    {
        "id": "1164861b07b7219c",
        "type": "comment",
        "z": "566d3f2244bf2252",
        "name": "Get OAuth2 token: admin (temporary)",
        "info": "",
        "x": 250,
        "y": 220,
        "wires": []
    },
    {
        "id": "93288cb3d216bccd",
        "type": "comment",
        "z": "566d3f2244bf2252",
        "name": "Get OAuth2 token: admin (permanent)",
        "info": "",
        "x": 250,
        "y": 300,
        "wires": []
    },
    {
        "id": "2b1f28ca946c0105",
        "type": "inject",
        "z": "566d3f2244bf2252",
        "name": "execute request",
        "props": [
            {
                "p": "keyrock_ip",
                "v": "keyrock_ip",
                "vt": "flow"
            },
            {
                "p": "keyrock_puerto",
                "v": "keyrock_puerto",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_id",
                "v": "keyrock_oauth2_client_id",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_secret",
                "v": "keyrock_oauth2_client_secret",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "username=admin@test.com&password=1234567890&grant_type=password",
        "payloadType": "str",
        "x": 200,
        "y": 260,
        "wires": [
            [
                "b891ea9328450f99"
            ]
        ]
    },
    {
        "id": "92e0765facbac4dc",
        "type": "inject",
        "z": "566d3f2244bf2252",
        "name": "execute request",
        "props": [
            {
                "p": "keyrock_ip",
                "v": "keyrock_ip",
                "vt": "flow"
            },
            {
                "p": "keyrock_puerto",
                "v": "keyrock_puerto",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_id",
                "v": "keyrock_oauth2_client_id",
                "vt": "flow"
            },
            {
                "p": "keyrock_oauth2_client_secret",
                "v": "keyrock_oauth2_client_secret",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "username=admin@test.com&password=1234567890&grant_type=password&scope=permanent",
        "payloadType": "str",
        "x": 200,
        "y": 340,
        "wires": [
            [
                "b891ea9328450f99"
            ]
        ]
    },
    {
        "id": "b891ea9328450f99",
        "type": "http request",
        "z": "566d3f2244bf2252",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{keyrock_oauth2_client_id}}}:{{{keyrock_oauth2_client_secret}}}@{{{keyrock_ip}}}:{{{keyrock_puerto}}}/oauth2/token",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/x-www-form-urlencoded"
            }
        ],
        "x": 410,
        "y": 340,
        "wires": [
            [
                "a0be94c5a419c949"
            ]
        ]
    },
    {
        "id": "a0be94c5a419c949",
        "type": "json",
        "z": "566d3f2244bf2252",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 280,
        "wires": [
            [
                "cc832feef9563c04",
                "8185d012b9875945"
            ]
        ]
    },
    {
        "id": "cc832feef9563c04",
        "type": "debug",
        "z": "566d3f2244bf2252",
        "name": "get oauth2 token",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 280,
        "wires": []
    },
    {
        "id": "8185d012b9875945",
        "type": "change",
        "z": "566d3f2244bf2252",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "global",
                "to": "payload.access_token",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 970,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "bac8f882bce874eb",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "192.168.42.10",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 60,
        "wires": [
            [
                "f9aac64bbd544e0b"
            ]
        ]
    },
    {
        "id": "f9aac64bbd544e0b",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "18ae5d6a34ca0b48",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Services",
        "info": "",
        "x": 120,
        "y": 140,
        "wires": []
    },
    {
        "id": "1ceee7d2cc89e91a",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Get services",
        "info": "",
        "x": 170,
        "y": 180,
        "wires": []
    },
    {
        "id": "33609fd09b868eb5",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 220,
        "wires": [
            [
                "3bc8b031bf166c4e"
            ]
        ]
    },
    {
        "id": "3bc8b031bf166c4e",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 220,
        "wires": [
            [
                "662ceceaf7d0354a"
            ]
        ]
    },
    {
        "id": "662ceceaf7d0354a",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 220,
        "wires": [
            [
                "3716cc03db90c696"
            ]
        ]
    },
    {
        "id": "3716cc03db90c696",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "get services",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 220,
        "wires": []
    },
    {
        "id": "73205f8af2f33e8c",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Create service (Inject key after)",
        "info": "",
        "x": 230,
        "y": 360,
        "wires": []
    },
    {
        "id": "1384d7fa225f4e35",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"services\":[{\"apikey\":\"1234567890\",\"cbroker\":\"https://192.168.42.20:1026\",\"entity_type\":\"Thing\",\"resource\":\"/iot/json\"}]}",
        "payloadType": "json",
        "x": 200,
        "y": 400,
        "wires": [
            [
                "c3ba3c67fc6332a2"
            ]
        ]
    },
    {
        "id": "c3ba3c67fc6332a2",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 400,
        "wires": [
            [
                "83e85eb1fa6cae75"
            ]
        ]
    },
    {
        "id": "4ef599f48e3a1869",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 440,
        "wires": [
            [
                "22a8c5c6fc1dfa0b"
            ]
        ]
    },
    {
        "id": "22a8c5c6fc1dfa0b",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "create services",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 400,
        "wires": []
    },
    {
        "id": "83e85eb1fa6cae75",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 400,
        "wires": [
            [
                "22a8c5c6fc1dfa0b"
            ],
            [
                "4ef599f48e3a1869"
            ]
        ]
    },
    {
        "id": "8300bdfb8dfd441f",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Delete service",
        "info": "",
        "x": 170,
        "y": 620,
        "wires": []
    },
    {
        "id": "0ac63a654b422f43",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "resource",
                "v": "/iot/json",
                "vt": "str"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 660,
        "wires": [
            [
                "026bb319c3556684"
            ]
        ]
    },
    {
        "id": "026bb319c3556684",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services/?resource={{{resource}}}&apikey={{{api_key}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 660,
        "wires": [
            [
                "c863c398a2bdfc4c"
            ]
        ]
    },
    {
        "id": "05aac373f7a2175b",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 700,
        "wires": [
            [
                "fb758b5444aa07aa"
            ]
        ]
    },
    {
        "id": "fb758b5444aa07aa",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "delete service",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 660,
        "wires": []
    },
    {
        "id": "c863c398a2bdfc4c",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 660,
        "wires": [
            [
                "fb758b5444aa07aa"
            ],
            [
                "05aac373f7a2175b"
            ]
        ]
    },
    {
        "id": "f0d11c436ec21feb",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Devices",
        "info": "",
        "x": 110,
        "y": 780,
        "wires": []
    },
    {
        "id": "795964cacacfc1f4",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Get devices",
        "info": "",
        "x": 170,
        "y": 840,
        "wires": []
    },
    {
        "id": "ae589aa777a25916",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 880,
        "wires": [
            [
                "fdbd4d76ea93cc44"
            ]
        ]
    },
    {
        "id": "fdbd4d76ea93cc44",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 410,
        "y": 880,
        "wires": [
            [
                "936fee604ec32d05"
            ]
        ]
    },
    {
        "id": "936fee604ec32d05",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 880,
        "wires": [
            [
                "8ee9f96f38300ca6"
            ]
        ]
    },
    {
        "id": "8ee9f96f38300ca6",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "get devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 880,
        "wires": []
    },
    {
        "id": "d4c13dce70382cc0",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Create devices",
        "info": "",
        "x": 180,
        "y": 960,
        "wires": []
    },
    {
        "id": "74629b0568e1fbf5",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"devices\":[{\"device_id\":\"vc001\",\"entity_name\":\"urn:ngsi-ld:Calidad:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"quality\",\"type\":\"Number\"}]},{\"device_id\":\"vv001\",\"entity_name\":\"urn:ngsi-ld:Ventilador:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"on\",\"type\":\"Boolean\"}]},{\"device_id\":\"ev001\",\"entity_name\":\"urn:ngsi-ld:Viento:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"speed\",\"type\":\"Number\"}]},{\"device_id\":\"em001\",\"entity_name\":\"urn:ngsi-ld:Molino:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"on\",\"type\":\"Boolean\"}]},{\"device_id\":\"eb001\",\"entity_name\":\"urn:ngsi-ld:Bateria:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"on\",\"type\":\"Boolean\"}]},{\"device_id\":\"et001\",\"entity_name\":\"urn:ngsi-ld:TBateria:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"temp\",\"type\":\"Number\"}]},{\"device_id\":\"ae001\",\"entity_name\":\"urn:ngsi-ld:EPuerta:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"locked\",\"type\":\"Boolean\"}]},{\"device_id\":\"ai001\",\"entity_name\":\"urn:ngsi-ld:IPuerta:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"locked\",\"type\":\"Boolean\"}]},{\"device_id\":\"as001\",\"entity_name\":\"urn:ngsi-ld:SIncendios:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"alarm\",\"type\":\"Boolean\"}]},{\"device_id\":\"hc001\",\"entity_name\":\"urn:ngsi-ld:Compuertas:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"locked\",\"type\":\"Boolean\"}]},{\"device_id\":\"hca001\",\"entity_name\":\"urn:ngsi-ld:CalidadAgua:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"quality\",\"type\":\"Number\"}]},{\"device_id\":\"hct001\",\"entity_name\":\"urn:ngsi-ld:CapacidadTanque:001\",\"entity_type\":\"Thing\",\"transport\":\"HTTPS\",\"attributes\":[{\"name\":\"capacity\",\"type\":\"Number\"}]}]}",
        "payloadType": "json",
        "x": 200,
        "y": 1000,
        "wires": [
            [
                "76db52ecf00db09a"
            ]
        ]
    },
    {
        "id": "76db52ecf00db09a",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 1000,
        "wires": [
            [
                "5c6e481c50b3ac28",
                "aaeb52d90379702b"
            ]
        ]
    },
    {
        "id": "c8adf32cb86ce423",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 1040,
        "wires": [
            [
                "8c4cbf7938687b61"
            ]
        ]
    },
    {
        "id": "8c4cbf7938687b61",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "create devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 1000,
        "wires": []
    },
    {
        "id": "5c6e481c50b3ac28",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 1000,
        "wires": [
            [
                "8c4cbf7938687b61"
            ],
            [
                "c8adf32cb86ce423"
            ]
        ]
    },
    {
        "id": "ee27e64d3fc27fb1",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Delete devices",
        "info": "",
        "x": 200,
        "y": 1860,
        "wires": []
    },
    {
        "id": "f7ad1734063e1cab",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "lamp002",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 1940,
        "wires": [
            [
                "4cf8d4b6263c0bcb"
            ]
        ]
    },
    {
        "id": "4cf8d4b6263c0bcb",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices/{{{device_id}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 430,
        "y": 2020,
        "wires": [
            [
                "51d1262828db56a9"
            ]
        ]
    },
    {
        "id": "9fb4a515a19028d1",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 2000,
        "wires": [
            [
                "c4f91e92f2eda115"
            ]
        ]
    },
    {
        "id": "c4f91e92f2eda115",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "delete device",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 1960,
        "wires": []
    },
    {
        "id": "51d1262828db56a9",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 610,
        "y": 1960,
        "wires": [
            [
                "c4f91e92f2eda115"
            ],
            [
                "9fb4a515a19028d1"
            ]
        ]
    },
    {
        "id": "3be41d8637b52830",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Delete device: lamp001",
        "info": "",
        "x": 220,
        "y": 1900,
        "wires": []
    },
    {
        "id": "bcfe04026d7587be",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "lamp001",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 2020,
        "wires": [
            [
                "4cf8d4b6263c0bcb"
            ]
        ]
    },
    {
        "id": "f9b06834e33660ca",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Delete device: lamp002",
        "info": "",
        "x": 220,
        "y": 1980,
        "wires": []
    },
    {
        "id": "2e77a64dbd96856c",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Update devices",
        "info": "",
        "x": 200,
        "y": 2780,
        "wires": []
    },
    {
        "id": "0975f2eb4c5d4ef9",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp001",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"o\":0}",
        "payloadType": "json",
        "x": 220,
        "y": 2860,
        "wires": [
            [
                "ac75c60e0c28dafa"
            ]
        ]
    },
    {
        "id": "ac75c60e0c28dafa",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 430,
        "y": 2940,
        "wires": [
            [
                "daf8845351c1c749"
            ]
        ]
    },
    {
        "id": "0dd95efd147345e0",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 2920,
        "wires": [
            [
                "23327e273508cf1c"
            ]
        ]
    },
    {
        "id": "23327e273508cf1c",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 960,
        "y": 2880,
        "wires": []
    },
    {
        "id": "daf8845351c1c749",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 610,
        "y": 2880,
        "wires": [
            [
                "23327e273508cf1c"
            ],
            [
                "0dd95efd147345e0"
            ]
        ]
    },
    {
        "id": "eb3df3c4b287f0a3",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Update device lamp001: set on to 0",
        "info": "",
        "x": 260,
        "y": 2820,
        "wires": []
    },
    {
        "id": "6c6ad5a8ca3fd4a5",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp001",
                "vt": "str"
            },
            {
                "p": "payload"
            },
            {
                "p": "rejectUnauthorized",
                "v": "false",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"o\":1}",
        "payloadType": "json",
        "x": 220,
        "y": 2940,
        "wires": [
            [
                "ac75c60e0c28dafa"
            ]
        ]
    },
    {
        "id": "8d27f2d221f14c07",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Update device lamp001: set on to 1",
        "info": "",
        "x": 260,
        "y": 2900,
        "wires": []
    },
    {
        "id": "1aa0066d451836f7",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp002",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"on\":0}",
        "payloadType": "json",
        "x": 220,
        "y": 3060,
        "wires": [
            [
                "7a7d064c150b8a36"
            ]
        ]
    },
    {
        "id": "7a7d064c150b8a36",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 430,
        "y": 3080,
        "wires": [
            [
                "19d3e42c8786f351"
            ]
        ]
    },
    {
        "id": "840a56d7debe17e3",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 3120,
        "wires": [
            [
                "3778a21f829698fe"
            ]
        ]
    },
    {
        "id": "3778a21f829698fe",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 960,
        "y": 3080,
        "wires": []
    },
    {
        "id": "19d3e42c8786f351",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 610,
        "y": 3080,
        "wires": [
            [
                "3778a21f829698fe"
            ],
            [
                "840a56d7debe17e3"
            ]
        ]
    },
    {
        "id": "e93044a68901ea89",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Update device lamp002: set on to 0",
        "info": "",
        "x": 260,
        "y": 3020,
        "wires": []
    },
    {
        "id": "02edd6329006a76d",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "lamp002",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"on\":1}",
        "payloadType": "json",
        "x": 220,
        "y": 3100,
        "wires": [
            [
                "7a7d064c150b8a36"
            ]
        ]
    },
    {
        "id": "84eb583b3ca04794",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Update device lamp002: set on to 1",
        "info": "",
        "x": 260,
        "y": 3140,
        "wires": []
    },
    {
        "id": "6002524aea5435dc",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "Inject permanent key to service",
        "info": "",
        "x": 230,
        "y": 440,
        "wires": []
    },
    {
        "id": "9faef9bcb798e80d",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "resource",
                "v": "/iot/json",
                "vt": "str"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\t    \"cbroker\": \"https://192.168.42.20:1026\",\t    \"trust\": $globalContext(\"oauth2-token\")\t}",
        "payloadType": "jsonata",
        "x": 200,
        "y": 480,
        "wires": [
            [
                "ddedef5e69ab7df2"
            ]
        ]
    },
    {
        "id": "ddedef5e69ab7df2",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "PUT",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/services/?resource={{{resource}}}&apikey={{{api_key}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 410,
        "y": 480,
        "wires": [
            [
                "787f98972a26ba53"
            ]
        ]
    },
    {
        "id": "f6976fd4755581c5",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 520,
        "wires": [
            [
                "2f04834c3852db09"
            ]
        ]
    },
    {
        "id": "2f04834c3852db09",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "inject permanent key to service",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 990,
        "y": 480,
        "wires": []
    },
    {
        "id": "787f98972a26ba53",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 480,
        "wires": [
            [
                "2f04834c3852db09"
            ],
            [
                "f6976fd4755581c5"
            ]
        ]
    },
    {
        "id": "aaeb52d90379702b",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "debug 4",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 940,
        "wires": []
    },
    {
        "id": "cc45abeb2736667e",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_datos",
                "v": "iota_puerto_datos",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "api_key",
                "v": "1234567890",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 1100,
        "wires": [
            [
                "c7d2f0dbefa8c73e",
                "2f94de75dbdbd251",
                "c78f329c7d534791",
                "75b4bba9ed9b4c24",
                "dd4a0b1cb2287228",
                "862cb0afc8d89d20",
                "4331b9de7e006407",
                "527413ef71ee16eb",
                "20bd6bbb5f3a3e8e",
                "16f3ac186a4e8209",
                "080d6837fe70515d",
                "ecc0d58b07f40402"
            ]
        ]
    },
    {
        "id": "9c34aaed6a543207",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            }
        ],
        "x": 830,
        "y": 1400,
        "wires": [
            [
                "5efa13a2ac21016b"
            ]
        ]
    },
    {
        "id": "b67b87dc16fb8d24",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1130,
        "y": 1400,
        "wires": [
            [
                "c7209d09dc86fe9b"
            ]
        ]
    },
    {
        "id": "c7209d09dc86fe9b",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1280,
        "y": 1400,
        "wires": []
    },
    {
        "id": "5efa13a2ac21016b",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1010,
        "y": 1400,
        "wires": [
            [
                "c7209d09dc86fe9b"
            ],
            [
                "b67b87dc16fb8d24"
            ]
        ]
    },
    {
        "id": "c7d2f0dbefa8c73e",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vc001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"quality\": 95}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1100,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "11654ad7ab4ff5f0",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "SET INITIAL VALUES OF DEVICES",
        "info": "",
        "x": 240,
        "y": 1060,
        "wires": []
    },
    {
        "id": "2f94de75dbdbd251",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vv001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"on\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1160,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "c78f329c7d534791",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ev001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"speed\": 50}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1220,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "75b4bba9ed9b4c24",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "em001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"on\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1280,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "dd4a0b1cb2287228",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "eb001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"on\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1340,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "862cb0afc8d89d20",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "et001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"temp\": 25}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1400,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "4331b9de7e006407",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ae001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"locked\": true}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1460,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "527413ef71ee16eb",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ai001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"locked\": true}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1520,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "20bd6bbb5f3a3e8e",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "as001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"alarm\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1580,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "16f3ac186a4e8209",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hc001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"locked\": false}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1640,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "ecc0d58b07f40402",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hca001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"quality\": 95}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1700,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "080d6837fe70515d",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hct001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"capacity\": 65}",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1760,
        "wires": [
            [
                "9c34aaed6a543207"
            ]
        ]
    },
    {
        "id": "7f4fc0b336f1b61c",
        "type": "inject",
        "z": "b7399fc069e83146",
        "name": "execute request",
        "props": [
            {
                "p": "iota_ip",
                "v": "iota_ip",
                "vt": "flow"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "iota_puerto_gestion",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 2100,
        "wires": [
            [
                "5197a5cabd8c0ea1",
                "fd12b36d305fd24e",
                "7a711fb9dd87a161",
                "22225d827ad82860",
                "f0a6664fd3a20cab",
                "b5132c6d7234304d",
                "87033068b1759818",
                "2caec72fb1ab780a",
                "35b74509e96e481e",
                "aeab5d7817d921c0",
                "5efe4852effdb38f",
                "57b96329ce4b29a4"
            ]
        ]
    },
    {
        "id": "8c2ffd053a7af493",
        "type": "json",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1150,
        "y": 2380,
        "wires": [
            [
                "4deb6f8c0c86e96b"
            ]
        ]
    },
    {
        "id": "4deb6f8c0c86e96b",
        "type": "debug",
        "z": "b7399fc069e83146",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1300,
        "y": 2380,
        "wires": []
    },
    {
        "id": "0e80253d76533be1",
        "type": "switch",
        "z": "b7399fc069e83146",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1010,
        "y": 2380,
        "wires": [
            [
                "4deb6f8c0c86e96b"
            ],
            [
                "8c2ffd053a7af493"
            ]
        ]
    },
    {
        "id": "5197a5cabd8c0ea1",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vc001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2100,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "a6f6bbe187c00d81",
        "type": "comment",
        "z": "b7399fc069e83146",
        "name": "DELETE ALL DEVICES",
        "info": "",
        "x": 220,
        "y": 2060,
        "wires": []
    },
    {
        "id": "fd12b36d305fd24e",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "vv001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2160,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "7a711fb9dd87a161",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ev001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2220,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "22225d827ad82860",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "em001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2280,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "f0a6664fd3a20cab",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "eb001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2340,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "b5132c6d7234304d",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "et001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2400,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "87033068b1759818",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ae001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2460,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "2caec72fb1ab780a",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "ai001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2520,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "35b74509e96e481e",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "as001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2580,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "aeab5d7817d921c0",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hc001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2640,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "57b96329ce4b29a4",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hca001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2700,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "5efe4852effdb38f",
        "type": "change",
        "z": "b7399fc069e83146",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "hct001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 2760,
        "wires": [
            [
                "97e0cab150042925"
            ]
        ]
    },
    {
        "id": "97e0cab150042925",
        "type": "http request",
        "z": "b7399fc069e83146",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://{{{iota_ip}}}:{{{iota_puerto_gestion}}}/iot/devices/{{{device_id}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            }
        ],
        "x": 850,
        "y": 2380,
        "wires": [
            [
                "0e80253d76533be1"
            ]
        ]
    },
    {
        "id": "aa7b43002a9bb7ef",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 60,
        "wires": [
            [
                "b59b6b8288ced99d"
            ]
        ]
    },
    {
        "id": "b59b6b8288ced99d",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "8c696bfa2dd4f9c0",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 160,
        "wires": [
            [
                "114337df316b1c41"
            ]
        ]
    },
    {
        "id": "e32e90e2a69f27b8",
        "type": "json",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 570,
        "y": 160,
        "wires": [
            [
                "445799a7d377fa27"
            ]
        ]
    },
    {
        "id": "445799a7d377fa27",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "orion version",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 160,
        "wires": []
    },
    {
        "id": "90416c53d61b8d51",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Check orion version",
        "info": "",
        "x": 190,
        "y": 120,
        "wires": []
    },
    {
        "id": "114337df316b1c41",
        "type": "http request",
        "z": "459510cbb9db9ba8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/version",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 160,
        "wires": [
            [
                "e32e90e2a69f27b8",
                "a78364f04f457270"
            ]
        ]
    },
    {
        "id": "38be7282e8789ffa",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Entities",
        "info": "",
        "x": 110,
        "y": 240,
        "wires": []
    },
    {
        "id": "80531f067e50623d",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Get entities",
        "info": "",
        "x": 170,
        "y": 300,
        "wires": []
    },
    {
        "id": "44618e12edc7fe75",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 340,
        "wires": [
            [
                "2a9499653a0e20f8"
            ]
        ]
    },
    {
        "id": "2a9499653a0e20f8",
        "type": "http request",
        "z": "459510cbb9db9ba8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 340,
        "wires": [
            [
                "b91121f034aec75b"
            ]
        ]
    },
    {
        "id": "b91121f034aec75b",
        "type": "json",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 340,
        "wires": [
            [
                "5b254f2d7703565d"
            ]
        ]
    },
    {
        "id": "5b254f2d7703565d",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "get entities",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 340,
        "wires": []
    },
    {
        "id": "565c39d1dcdf7399",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Delete one entity",
        "info": "",
        "x": 180,
        "y": 420,
        "wires": []
    },
    {
        "id": "a1370b89c7f0269f",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Lamp:001",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 460,
        "wires": [
            [
                "69c23414e3a2bb3c"
            ]
        ]
    },
    {
        "id": "69c23414e3a2bb3c",
        "type": "http request",
        "z": "459510cbb9db9ba8",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 410,
        "y": 460,
        "wires": [
            [
                "376f9df3b6d63681"
            ]
        ]
    },
    {
        "id": "086719c7933bbe03",
        "type": "json",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 500,
        "wires": [
            [
                "1ddcfe8801b8a425"
            ]
        ]
    },
    {
        "id": "1ddcfe8801b8a425",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "delete entity",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 460,
        "wires": []
    },
    {
        "id": "376f9df3b6d63681",
        "type": "switch",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 460,
        "wires": [
            [
                "1ddcfe8801b8a425"
            ],
            [
                "086719c7933bbe03"
            ]
        ]
    },
    {
        "id": "e887e09a1e7e51b7",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Entity attributes",
        "info": "",
        "x": 160,
        "y": 1600,
        "wires": []
    },
    {
        "id": "b85f4aa52f1144f1",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Get entity attribute: all",
        "info": "",
        "x": 220,
        "y": 1660,
        "wires": []
    },
    {
        "id": "678d539337cc7376",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "Thing:lamp002",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 1700,
        "wires": [
            [
                "098ffeb8880be142"
            ]
        ]
    },
    {
        "id": "098ffeb8880be142",
        "type": "http request",
        "z": "459510cbb9db9ba8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 430,
        "y": 1700,
        "wires": [
            [
                "0c73a45eb0909588"
            ]
        ]
    },
    {
        "id": "0c73a45eb0909588",
        "type": "json",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 810,
        "y": 1700,
        "wires": [
            [
                "315020b5e910f2a1"
            ]
        ]
    },
    {
        "id": "315020b5e910f2a1",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "get entity attribute: all",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1120,
        "y": 1700,
        "wires": []
    },
    {
        "id": "39f88674abdf421b",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Get entity attribute: on",
        "info": "",
        "x": 220,
        "y": 1780,
        "wires": []
    },
    {
        "id": "1390d38aaa7f81da",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Lamp:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 1820,
        "wires": [
            [
                "754f2dceee8cb270"
            ]
        ]
    },
    {
        "id": "2f1146b835979989",
        "type": "http request",
        "z": "459510cbb9db9ba8",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 630,
        "y": 1820,
        "wires": [
            [
                "e65d3c2f8e664249"
            ]
        ]
    },
    {
        "id": "e65d3c2f8e664249",
        "type": "json",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 810,
        "y": 1820,
        "wires": [
            [
                "eceac8aa2ee19c82"
            ]
        ]
    },
    {
        "id": "eceac8aa2ee19c82",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "get entity attribute: on",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1120,
        "y": 1820,
        "wires": []
    },
    {
        "id": "754f2dceee8cb270",
        "type": "trigger",
        "z": "459510cbb9db9ba8",
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-1",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 440,
        "y": 1820,
        "wires": [
            [
                "2f1146b835979989"
            ]
        ]
    },
    {
        "id": "a78364f04f457270",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "debug 2",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 120,
        "wires": []
    },
    {
        "id": "597c11f67355b3e0",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Calidad:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 600,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "5080f0fd81235e38",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 660,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "2db7573d9f1e27eb",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Viento:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 720,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "ca7b7fea1db1c4a3",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 780,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "90dae00a59665d4f",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 840,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "436b34c7d70acd30",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:TBateria:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 900,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "783651710321d82c",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 980,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "9cd6f455ad8f4dd1",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 1040,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "4b17dff557ea6393",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:SIncendios:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 1100,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "d62bb20982c868c3",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 1160,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "d21230d9655c39e4",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:TNivel:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 1220,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "9f8759f84f976897",
        "type": "change",
        "z": "459510cbb9db9ba8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:LNivel:001",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 1280,
        "wires": [
            [
                "7bc10c111b73ff17"
            ]
        ]
    },
    {
        "id": "6f64a27aafb0cc24",
        "type": "inject",
        "z": "459510cbb9db9ba8",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "Thing:lamp001",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 200,
        "y": 600,
        "wires": [
            [
                "597c11f67355b3e0",
                "5080f0fd81235e38",
                "2db7573d9f1e27eb",
                "ca7b7fea1db1c4a3",
                "90dae00a59665d4f",
                "436b34c7d70acd30",
                "783651710321d82c",
                "9cd6f455ad8f4dd1",
                "4b17dff557ea6393",
                "d62bb20982c868c3",
                "d21230d9655c39e4",
                "9f8759f84f976897"
            ]
        ]
    },
    {
        "id": "7bc10c111b73ff17",
        "type": "http request",
        "z": "459510cbb9db9ba8",
        "name": "",
        "method": "DELETE",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 850,
        "y": 940,
        "wires": [
            [
                "55252d3e32b60441"
            ]
        ]
    },
    {
        "id": "8afea774f1115263",
        "type": "json",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1110,
        "y": 1020,
        "wires": [
            [
                "dd37de8c3009c9e4"
            ]
        ]
    },
    {
        "id": "dd37de8c3009c9e4",
        "type": "debug",
        "z": "459510cbb9db9ba8",
        "name": "delete entity",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1210,
        "y": 940,
        "wires": []
    },
    {
        "id": "55252d3e32b60441",
        "type": "switch",
        "z": "459510cbb9db9ba8",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1010,
        "y": 940,
        "wires": [
            [
                "dd37de8c3009c9e4"
            ],
            [
                "8afea774f1115263"
            ]
        ]
    },
    {
        "id": "5ab71d7d7f3f906c",
        "type": "comment",
        "z": "459510cbb9db9ba8",
        "name": "Delete all entities",
        "info": "",
        "x": 180,
        "y": 560,
        "wires": []
    },
    {
        "id": "45624435efcfdf5b",
        "type": "inject",
        "z": "005d0f43a69b7907",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "10.0.2.15",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "wilma_port",
                "v": "1026",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 60,
        "wires": [
            [
                "3248e59b25d99f96"
            ]
        ]
    },
    {
        "id": "3248e59b25d99f96",
        "type": "change",
        "z": "005d0f43a69b7907",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "oauth-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "wilma_ip",
                "pt": "flow",
                "to": "wilma_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "wilma_port",
                "pt": "flow",
                "to": "wilma_port",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "3cb4abcc0e1b0b97",
        "type": "comment",
        "z": "005d0f43a69b7907",
        "name": "Sensor de temperatura de la bater√≠a",
        "info": "",
        "x": 180,
        "y": 540,
        "wires": []
    },
    {
        "id": "d1e193ede4e80b5d",
        "type": "inject",
        "z": "005d0f43a69b7907",
        "name": "Valores URL API",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 580,
        "wires": [
            [
                "9888c8c71165ab24"
            ]
        ]
    },
    {
        "id": "101fcc298f6a562d",
        "type": "mqtt out",
        "z": "005d0f43a69b7907",
        "name": "bateryTempValue",
        "topic": "bateryTempValue",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 830,
        "y": 580,
        "wires": []
    },
    {
        "id": "9888c8c71165ab24",
        "type": "trigger",
        "z": "005d0f43a69b7907",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-10",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 370,
        "y": 580,
        "wires": [
            [
                "c638018012b0eec2"
            ]
        ]
    },
    {
        "id": "a859d724951bd984",
        "type": "mqtt in",
        "z": "005d0f43a69b7907",
        "name": "bateryTempValue",
        "topic": "bateryTempValue",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 220,
        "y": 680,
        "wires": [
            [
                "785f2bba0c1eb6aa"
            ]
        ]
    },
    {
        "id": "785f2bba0c1eb6aa",
        "type": "change",
        "z": "005d0f43a69b7907",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "et001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 680,
        "wires": [
            [
                "9e30faa67020e019"
            ]
        ]
    },
    {
        "id": "9e30faa67020e019",
        "type": "http request",
        "z": "005d0f43a69b7907",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 650,
        "y": 680,
        "wires": [
            [
                "f244721a36ccdc11"
            ]
        ]
    },
    {
        "id": "51fd29c454f59bfd",
        "type": "debug",
        "z": "005d0f43a69b7907",
        "name": "update temp: StatusCode",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "statusCode",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 680,
        "wires": []
    },
    {
        "id": "f244721a36ccdc11",
        "type": "switch",
        "z": "005d0f43a69b7907",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 830,
        "y": 680,
        "wires": [
            [
                "51fd29c454f59bfd"
            ],
            []
        ]
    },
    {
        "id": "21d0c715cda5fdcd",
        "type": "comment",
        "z": "005d0f43a69b7907",
        "name": "Sensor de temperatura: Flujo actualizaci√≥n a IoTA",
        "info": "",
        "x": 320,
        "y": 640,
        "wires": []
    },
    {
        "id": "c638018012b0eec2",
        "type": "function",
        "z": "005d0f43a69b7907",
        "name": "Temperatura aleatoria",
        "func": "// Generar un n√∫mero aleatorio entre -10 y 50\n/*var temp = Math.floor(Math.random() * (50 - (-10) + 1)) + (-10);\nmsg.payload = {'temp': temp}\nreturn msg;*/\nconst r = Math.random() * 100;\nlet value = msg.temp_bateria ?? 25\nif (value > 50 || value < 5) {\n    value = 25\n}\nif (r <= 10 && value > 0) {\n    value -= 1\n} else if (r >= 90 && value < 100) {\n    value += 1\n}\nmsg.payload = { \"temp\": value }\nmsg.temp_bateria = value\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 580,
        "wires": [
            [
                "101fcc298f6a562d",
                "16a7bf4ffd837524"
            ]
        ]
    },
    {
        "id": "16a7bf4ffd837524",
        "type": "debug",
        "z": "005d0f43a69b7907",
        "name": "debug 18",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 620,
        "wires": []
    },
    {
        "id": "630acc758e67b8ee",
        "type": "inject",
        "z": "005d0f43a69b7907",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "wilma_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "wilma_port",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Bateria:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 800,
        "wires": [
            [
                "054ce1325f296a23"
            ]
        ]
    },
    {
        "id": "e2f3e4d98a78aef1",
        "type": "mqtt in",
        "z": "005d0f43a69b7907",
        "name": "updateBateria",
        "topic": "updateBateria",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1230,
        "y": 800,
        "wires": [
            [
                "5d86226c212c3f9c"
            ]
        ]
    },
    {
        "id": "5d86226c212c3f9c",
        "type": "function",
        "z": "005d0f43a69b7907",
        "name": "Update valor en bater√≠a",
        "func": "msg.payload = {'on': msg.payload}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1430,
        "y": 800,
        "wires": [
            [
                "afb6b1cfedb36346"
            ]
        ]
    },
    {
        "id": "af4508dfd7ca6782",
        "type": "comment",
        "z": "005d0f43a69b7907",
        "name": "Actuador Molino",
        "info": "",
        "x": 120,
        "y": 400,
        "wires": []
    },
    {
        "id": "d26489e99c0d9549",
        "type": "mqtt in",
        "z": "005d0f43a69b7907",
        "name": "updateMolino",
        "topic": "updateMolino",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1370,
        "y": 440,
        "wires": [
            [
                "8742517f31290418"
            ]
        ]
    },
    {
        "id": "8742517f31290418",
        "type": "function",
        "z": "005d0f43a69b7907",
        "name": "Update valor en molino",
        "func": "msg.payload = {'on': msg.payload}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1590,
        "y": 440,
        "wires": [
            [
                "ba2854097703646f"
            ]
        ]
    },
    {
        "id": "cd1984e83e0341f4",
        "type": "inject",
        "z": "005d0f43a69b7907",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "wilma_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "wilma_port",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Molino:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 440,
        "wires": [
            [
                "e5ba82fb95af66ee"
            ]
        ]
    },
    {
        "id": "d8d4870aacc00f41",
        "type": "mqtt out",
        "z": "005d0f43a69b7907",
        "name": "updateMolino",
        "topic": "updateMolino",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1160,
        "y": 440,
        "wires": []
    },
    {
        "id": "9202746bcf716957",
        "type": "mqtt out",
        "z": "005d0f43a69b7907",
        "name": "updateBateria",
        "topic": "updateBateria",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1040,
        "y": 800,
        "wires": []
    },
    {
        "id": "ba2854097703646f",
        "type": "debug",
        "z": "005d0f43a69b7907",
        "name": "debug 21",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1820,
        "y": 440,
        "wires": []
    },
    {
        "id": "afb6b1cfedb36346",
        "type": "debug",
        "z": "005d0f43a69b7907",
        "name": "debug 22",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1620,
        "y": 800,
        "wires": []
    },
    {
        "id": "e5ba82fb95af66ee",
        "type": "trigger",
        "z": "005d0f43a69b7907",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 360,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "054ce1325f296a23",
        "type": "trigger",
        "z": "005d0f43a69b7907",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 340,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "71c18c874b7baddb",
        "type": "inject",
        "z": "68944cea84c8b461",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Compuertas:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "locked",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 820,
        "wires": [
            [
                "dd3358a583c9492d"
            ]
        ]
    },
    {
        "id": "cff5da043b4b4611",
        "type": "inject",
        "z": "68944cea84c8b461",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "velocidad_viento",
                "v": "calidad_agua",
                "vt": "flow"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "hidraulico/calidad",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 180,
        "wires": [
            [
                "de540245e48015fd"
            ]
        ]
    },
    {
        "id": "5bc2475002568fc6",
        "type": "inject",
        "z": "68944cea84c8b461",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "velocidad_viento",
                "v": "capacidad_tanque",
                "vt": "flow"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "hidraulico/capacidad",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 460,
        "wires": [
            [
                "c0a24dd6120d4e50"
            ]
        ]
    },
    {
        "id": "613e067a72b148d6",
        "type": "inject",
        "z": "68944cea84c8b461",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "10.0.2.15",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 40,
        "wires": [
            [
                "5d493ef0927e5be5"
            ]
        ]
    },
    {
        "id": "5d493ef0927e5be5",
        "type": "change",
        "z": "68944cea84c8b461",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "7b18825690b4e560",
        "type": "inject",
        "z": "68944cea84c8b461",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 80,
        "wires": [
            [
                "76966778039d73a7"
            ]
        ]
    },
    {
        "id": "76966778039d73a7",
        "type": "change",
        "z": "68944cea84c8b461",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "f97256ecf1a4bab6",
        "type": "comment",
        "z": "68944cea84c8b461",
        "name": "Calidad de agua: Flujo actualizaci√≥n a IoTA",
        "info": "",
        "x": 260,
        "y": 240,
        "wires": []
    },
    {
        "id": "0af671838c734ec4",
        "type": "comment",
        "z": "68944cea84c8b461",
        "name": "Capacidad de tanque: Flujo actualizaci√≥n a IoTA",
        "info": "",
        "x": 280,
        "y": 540,
        "wires": []
    },
    {
        "id": "275e2437a8185d89",
        "type": "mqtt in",
        "z": "68944cea84c8b461",
        "name": "",
        "topic": "updateCompuerta",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1170,
        "y": 820,
        "wires": [
            [
                "c45c1498bbab411a"
            ]
        ]
    },
    {
        "id": "c45c1498bbab411a",
        "type": "function",
        "z": "68944cea84c8b461",
        "name": "Update valor en compuerta",
        "func": "msg.payload = {'locked': msg.payload}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1400,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "dd3358a583c9492d",
        "type": "trigger",
        "z": "68944cea84c8b461",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 300,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "de540245e48015fd",
        "type": "trigger",
        "z": "68944cea84c8b461",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 300,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "c0a24dd6120d4e50",
        "type": "trigger",
        "z": "68944cea84c8b461",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 320,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "c7c8ee93a178d57b",
        "type": "inject",
        "z": "2c53247ebc271023",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:EPuerta:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "locked",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "9bf7ab622980292a",
        "type": "inject",
        "z": "2c53247ebc271023",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:IPuerta:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "locked",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "4086a0c7ad44f451",
        "type": "inject",
        "z": "2c53247ebc271023",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "10.0.2.15",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 40,
        "wires": [
            [
                "9098e9469f345e71"
            ]
        ]
    },
    {
        "id": "9098e9469f345e71",
        "type": "change",
        "z": "2c53247ebc271023",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "3fe32b98ee7d78fb",
        "type": "inject",
        "z": "2c53247ebc271023",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 80,
        "wires": [
            [
                "2e4453999728f4f5"
            ]
        ]
    },
    {
        "id": "2e4453999728f4f5",
        "type": "change",
        "z": "2c53247ebc271023",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "1f60a620a429d993",
        "type": "inject",
        "z": "cc2710ecf2b1876d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "calidad_aire",
                "v": "calidad_aire",
                "vt": "flow"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "ventilacion/calidad",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 300,
        "wires": [
            [
                "2650cd2d8354304b"
            ]
        ]
    },
    {
        "id": "2d24cc7ddae4d6be",
        "type": "inject",
        "z": "cc2710ecf2b1876d",
        "name": "flow variables",
        "props": [
            {
                "p": "iota_ip",
                "v": "10.0.2.15",
                "vt": "str"
            },
            {
                "p": "iota_puerto_gestion",
                "v": "4061",
                "vt": "str"
            },
            {
                "p": "iota_puerto_datos",
                "v": "7896",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 60,
        "wires": [
            [
                "39fcd8eb07974e6e"
            ]
        ]
    },
    {
        "id": "39fcd8eb07974e6e",
        "type": "change",
        "z": "cc2710ecf2b1876d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "flow",
                "to": "iota_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_gestion",
                "pt": "flow",
                "to": "iota_puerto_gestion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "flow",
                "to": "iota_puerto_datos",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "fc3df4060206b58e",
        "type": "inject",
        "z": "cc2710ecf2b1876d",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 130,
        "y": 100,
        "wires": [
            [
                "64bd8dd0c83b8c1e"
            ]
        ]
    },
    {
        "id": "64bd8dd0c83b8c1e",
        "type": "change",
        "z": "cc2710ecf2b1876d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "201c8b1f5b68e5de",
        "type": "inject",
        "z": "cc2710ecf2b1876d",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Ventilador:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 140,
        "y": 480,
        "wires": [
            [
                "2432b31bc18c04fe"
            ]
        ]
    },
    {
        "id": "2432b31bc18c04fe",
        "type": "trigger",
        "z": "cc2710ecf2b1876d",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 360,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "2650cd2d8354304b",
        "type": "trigger",
        "z": "cc2710ecf2b1876d",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 340,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "e5b6158bb657cdcc",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "flow variables",
        "props": [
            {
                "p": "orion_ip",
                "v": "192.168.41.20",
                "vt": "str"
            },
            {
                "p": "orion_puerto",
                "v": "1026",
                "vt": "str"
            },
            {
                "p": "fiware_service",
                "v": "sco",
                "vt": "str"
            },
            {
                "p": "fiware_servicepath",
                "v": "/",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 190,
        "y": 100,
        "wires": [
            [
                "cee85462591887be"
            ]
        ]
    },
    {
        "id": "cee85462591887be",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "flow",
                "to": "orion_ip",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "flow",
                "to": "orion_puerto",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "flow",
                "to": "fiware_service",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "flow",
                "to": "fiware_servicepath",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "molino_prev_state",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "bateria_prev_state",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "ventilador_prev_state",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "59b0de493be5191e",
        "type": "ui_gauge",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "gage",
        "title": "Temperatura Bateria",
        "label": "C¬∫",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#f5c211",
            "#c01c28"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1040,
        "y": 2040,
        "wires": []
    },
    {
        "id": "6e097e93e3aafdc4",
        "type": "ui_switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "label": "Ventilador",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 700,
        "y": 500,
        "wires": [
            [
                "60aecd8af4c8b6e4"
            ]
        ]
    },
    {
        "id": "96207c3319c049f7",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Ventilador Switch",
        "info": "",
        "x": 160,
        "y": 460,
        "wires": []
    },
    {
        "id": "75e77d07eec5aa9a",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Ventilador:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 500,
        "wires": [
            [
                "9758e3e18f3f317d"
            ]
        ]
    },
    {
        "id": "9758e3e18f3f317d",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 500,
        "wires": [
            [
                "5d7032ad591c7471"
            ]
        ]
    },
    {
        "id": "5d7032ad591c7471",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 500,
        "wires": [
            [
                "6e097e93e3aafdc4"
            ]
        ]
    },
    {
        "id": "60aecd8af4c8b6e4",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 4",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 500,
        "wires": [
            [
                "65c020589e646cbe"
            ]
        ]
    },
    {
        "id": "65c020589e646cbe",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 500,
        "wires": [
            [
                "b74f960aac0f2340"
            ]
        ]
    },
    {
        "id": "b74f960aac0f2340",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1250,
        "y": 500,
        "wires": [
            [
                "88efd67a3c48a525"
            ]
        ]
    },
    {
        "id": "c75e03001aead0a1",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1570,
        "y": 520,
        "wires": [
            [
                "17eee02c492fbbbc"
            ]
        ]
    },
    {
        "id": "17eee02c492fbbbc",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1760,
        "y": 500,
        "wires": []
    },
    {
        "id": "88efd67a3c48a525",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1430,
        "y": 500,
        "wires": [
            [
                "17eee02c492fbbbc"
            ],
            [
                "c75e03001aead0a1"
            ]
        ]
    },
    {
        "id": "d42b366f14846d47",
        "type": "ui_switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "label": "Molino",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 690,
        "y": 620,
        "wires": [
            [
                "f028fead990544ae"
            ]
        ]
    },
    {
        "id": "d3b5fe4889a17c45",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Molino Switch",
        "info": "",
        "x": 150,
        "y": 580,
        "wires": []
    },
    {
        "id": "68d2eaeefc3bf429",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Molino:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 620,
        "wires": [
            [
                "a822b950eeef0480"
            ]
        ]
    },
    {
        "id": "a822b950eeef0480",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 620,
        "wires": [
            [
                "f8c0e950f18fd46a"
            ]
        ]
    },
    {
        "id": "f8c0e950f18fd46a",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 620,
        "wires": [
            [
                "d42b366f14846d47"
            ]
        ]
    },
    {
        "id": "f028fead990544ae",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 5",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 620,
        "wires": [
            [
                "899199ddb0f52bf7"
            ]
        ]
    },
    {
        "id": "899199ddb0f52bf7",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 620,
        "wires": [
            [
                "63f35a239be2e789"
            ]
        ]
    },
    {
        "id": "63f35a239be2e789",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1250,
        "y": 620,
        "wires": [
            [
                "7961982ae5641b45"
            ]
        ]
    },
    {
        "id": "e145207aeddfb6d0",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1570,
        "y": 640,
        "wires": [
            [
                "0a8dbd62b4d20647"
            ]
        ]
    },
    {
        "id": "0a8dbd62b4d20647",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1760,
        "y": 620,
        "wires": []
    },
    {
        "id": "7961982ae5641b45",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1430,
        "y": 620,
        "wires": [
            [
                "0a8dbd62b4d20647"
            ],
            [
                "e145207aeddfb6d0"
            ]
        ]
    },
    {
        "id": "7f38cd6cea012a0c",
        "type": "ui_switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "label": "Bateria",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 700,
        "y": 740,
        "wires": [
            [
                "c53eaabb9a21916d"
            ]
        ]
    },
    {
        "id": "23ee539e861a589f",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Bateria Switch",
        "info": "",
        "x": 150,
        "y": 700,
        "wires": []
    },
    {
        "id": "ca6c855b4ad15cec",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Bateria:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "on",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 740,
        "wires": [
            [
                "37c15a6e1a72e45a"
            ]
        ]
    },
    {
        "id": "37c15a6e1a72e45a",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 740,
        "wires": [
            [
                "c3fa5a022521ab39"
            ]
        ]
    },
    {
        "id": "c53eaabb9a21916d",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 6",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 740,
        "wires": [
            [
                "d577fca4f8bc46e4"
            ]
        ]
    },
    {
        "id": "d577fca4f8bc46e4",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 740,
        "wires": [
            [
                "3ab99ced57ad8ce8"
            ]
        ]
    },
    {
        "id": "3ab99ced57ad8ce8",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1250,
        "y": 740,
        "wires": [
            [
                "5242ef82f195b42a"
            ]
        ]
    },
    {
        "id": "56ae79ae880fec3f",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1570,
        "y": 760,
        "wires": [
            [
                "cd440d77fe5d5743"
            ]
        ]
    },
    {
        "id": "cd440d77fe5d5743",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1760,
        "y": 740,
        "wires": []
    },
    {
        "id": "5242ef82f195b42a",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1430,
        "y": 740,
        "wires": [
            [
                "cd440d77fe5d5743"
            ],
            [
                "56ae79ae880fec3f"
            ]
        ]
    },
    {
        "id": "a2521056327660ed",
        "type": "ui_switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "label": "Puerta Exterior",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 880,
        "y": 860,
        "wires": [
            [
                "6ee22d65c8e92376"
            ]
        ]
    },
    {
        "id": "6571e5bb42a7e29b",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Puerta Exterior Switch",
        "info": "",
        "x": 180,
        "y": 820,
        "wires": []
    },
    {
        "id": "fab3af8632752532",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:EPuerta:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "locked",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 860,
        "wires": [
            [
                "9fa5d4d422809b11"
            ]
        ]
    },
    {
        "id": "9fa5d4d422809b11",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 860,
        "wires": [
            [
                "4066203e5df3f4ab"
            ]
        ]
    },
    {
        "id": "6ee22d65c8e92376",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 8",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 860,
        "wires": [
            [
                "25bd37686c8018c3"
            ]
        ]
    },
    {
        "id": "25bd37686c8018c3",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:EPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1220,
        "y": 860,
        "wires": [
            [
                "ea9fa71a9ad1b8a4"
            ]
        ]
    },
    {
        "id": "ea9fa71a9ad1b8a4",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1410,
        "y": 860,
        "wires": [
            [
                "76f63142c34dd659"
            ]
        ]
    },
    {
        "id": "689d4fd6b073851c",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1730,
        "y": 880,
        "wires": [
            [
                "64066e5245fd75f4"
            ]
        ]
    },
    {
        "id": "64066e5245fd75f4",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1920,
        "y": 860,
        "wires": []
    },
    {
        "id": "76f63142c34dd659",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1590,
        "y": 860,
        "wires": [
            [
                "64066e5245fd75f4"
            ],
            [
                "689d4fd6b073851c"
            ]
        ]
    },
    {
        "id": "efb114aa73703822",
        "type": "ui_switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "label": "Puerta Interior",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": false,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 880,
        "y": 980,
        "wires": [
            [
                "177e9b90bb66d346",
                "8daa273baee63ec8"
            ]
        ]
    },
    {
        "id": "a013dc18456b5c11",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Compuerta Interior Switch",
        "info": "",
        "x": 190,
        "y": 940,
        "wires": []
    },
    {
        "id": "7a254f5bb82b7908",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "Puerta request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:IPuerta:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "locked",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 980,
        "wires": [
            [
                "637adf5a40b43ab7"
            ]
        ]
    },
    {
        "id": "637adf5a40b43ab7",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 980,
        "wires": [
            [
                "fd1ee18201294ee9"
            ]
        ]
    },
    {
        "id": "177e9b90bb66d346",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 9",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 980,
        "wires": [
            [
                "b2cd14308f2c228f"
            ]
        ]
    },
    {
        "id": "b2cd14308f2c228f",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:IPuerta:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1220,
        "y": 980,
        "wires": [
            [
                "9b64390b07f305e7"
            ]
        ]
    },
    {
        "id": "9b64390b07f305e7",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1410,
        "y": 980,
        "wires": [
            [
                "cca1197f52b986cc"
            ]
        ]
    },
    {
        "id": "16eafcd71c779286",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1730,
        "y": 1000,
        "wires": [
            [
                "43c28b4763b8ad5e"
            ]
        ]
    },
    {
        "id": "43c28b4763b8ad5e",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1920,
        "y": 980,
        "wires": []
    },
    {
        "id": "cca1197f52b986cc",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1590,
        "y": 980,
        "wires": [
            [
                "43c28b4763b8ad5e"
            ],
            [
                "16eafcd71c779286"
            ]
        ]
    },
    {
        "id": "2a85e3a01feedc1d",
        "type": "ui_switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "label": "Compuertas Agua",
        "tooltip": "",
        "group": "95bc0ee9d93efab4",
        "order": 2,
        "width": "8",
        "height": "2",
        "passthru": true,
        "decouple": "false",
        "topic": "payload.value",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 730,
        "y": 1120,
        "wires": [
            [
                "b2906e4aca56660a"
            ]
        ]
    },
    {
        "id": "f4e174941e88eea5",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Compuertas Hidraulicas Switch",
        "info": "",
        "x": 210,
        "y": 1080,
        "wires": []
    },
    {
        "id": "9e5da960a1c3ce4f",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "Puerta request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Compuertas:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "locked",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 1120,
        "wires": [
            [
                "d43b7446d57b5161"
            ]
        ]
    },
    {
        "id": "d43b7446d57b5161",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 1120,
        "wires": [
            [
                "8912f4e490e947a6"
            ]
        ]
    },
    {
        "id": "8912f4e490e947a6",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 1120,
        "wires": [
            [
                "2a85e3a01feedc1d"
            ]
        ]
    },
    {
        "id": "51bd746154d26c42",
        "type": "ui_audio",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "voice": "urn:moz-tts:speechd:Spanish%20(Spain)+Marcelo?es",
        "always": true,
        "x": 1340,
        "y": 1260,
        "wires": []
    },
    {
        "id": "e3ab14ee60bcfe6d",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 950,
        "y": 1260,
        "wires": [
            [
                "f481a0de597d089a"
            ]
        ]
    },
    {
        "id": "f481a0de597d089a",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Alerta, Alerta, se est√° produciendo un incendio. Repito, incendio. Evacuen inmediatamente.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 1260,
        "wires": [
            [
                "51bd746154d26c42"
            ]
        ]
    },
    {
        "id": "6bc8145101b06ce0",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Alerta Alarma Incendio",
        "info": "",
        "x": 180,
        "y": 1220,
        "wires": []
    },
    {
        "id": "304526d094e34b48",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "Puerta request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:SIncendios:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "alarm",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 1260,
        "wires": [
            [
                "97cef558f2548bd6"
            ]
        ]
    },
    {
        "id": "97cef558f2548bd6",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 390,
        "y": 1260,
        "wires": [
            [
                "043c7590475922ad"
            ]
        ]
    },
    {
        "id": "043c7590475922ad",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 1260,
        "wires": [
            [
                "cc17d50ea67db202"
            ]
        ]
    },
    {
        "id": "cc17d50ea67db202",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 7",
        "func": "msg.payload = msg.payload.value != \"true\"\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 1260,
        "wires": [
            [
                "e3ab14ee60bcfe6d"
            ]
        ]
    },
    {
        "id": "fb90f7ef386d32cb",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Get Calidad Agua",
        "info": "",
        "x": 1020,
        "y": 200,
        "wires": []
    },
    {
        "id": "c52f8bf14e1f4115",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:CalidadAgua:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "quality",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1040,
        "y": 240,
        "wires": [
            [
                "0e47d3d6f0d5ec5f"
            ]
        ]
    },
    {
        "id": "0e47d3d6f0d5ec5f",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1250,
        "y": 240,
        "wires": [
            [
                "9cbb96709928fb6a"
            ]
        ]
    },
    {
        "id": "9cbb96709928fb6a",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1390,
        "y": 240,
        "wires": [
            [
                "829acdd181bf8fa9"
            ]
        ]
    },
    {
        "id": "829acdd181bf8fa9",
        "type": "ui_gauge",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "gage",
        "title": "Calidad Agua",
        "label": "%",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#c01c28",
            "#e5a50a",
            "#26a269"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 1600,
        "y": 240,
        "wires": []
    },
    {
        "id": "eef0a2b468f2a676",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Get Capacidad Tanque ",
        "info": "",
        "x": 1040,
        "y": 320,
        "wires": []
    },
    {
        "id": "e48ac4857883b87b",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:CapacidadTanque:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "capacity",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1040,
        "y": 360,
        "wires": [
            [
                "9d62c8276c11ae7d"
            ]
        ]
    },
    {
        "id": "9d62c8276c11ae7d",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1250,
        "y": 360,
        "wires": [
            [
                "564160bf215298bd"
            ]
        ]
    },
    {
        "id": "564160bf215298bd",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1390,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "03da372ed6a4d57c",
        "type": "ui_button",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 12,
        "width": "8",
        "height": "2",
        "passthru": false,
        "label": "Activar Alarma Incendios",
        "tooltip": "",
        "color": "",
        "bgcolor": "red",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 1030,
        "y": 1360,
        "wires": [
            [
                "f481a0de597d089a"
            ]
        ]
    },
    {
        "id": "dc194fa8af187c12",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 13",
        "func": "\nreturn msg.value;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 980,
        "wires": [
            [
                "efb114aa73703822"
            ]
        ]
    },
    {
        "id": "0440c8ecd407eb81",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 14",
        "func": "msg.payload = msg.payload.value;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 860,
        "wires": [
            [
                "a2521056327660ed"
            ]
        ]
    },
    {
        "id": "c3fa5a022521ab39",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 740,
        "wires": [
            [
                "7f38cd6cea012a0c"
            ]
        ]
    },
    {
        "id": "4066203e5df3f4ab",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 860,
        "wires": [
            [
                "0440c8ecd407eb81"
            ]
        ]
    },
    {
        "id": "fd1ee18201294ee9",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 550,
        "y": 980,
        "wires": [
            [
                "dc194fa8af187c12"
            ]
        ]
    },
    {
        "id": "8daa273baee63ec8",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "debug 16",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 920,
        "wires": []
    },
    {
        "id": "f448e315b575fcf6",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Automatizacion Molino",
        "info": "",
        "x": 180,
        "y": 1540,
        "wires": []
    },
    {
        "id": "d46d4b4d280c5617",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "Control Vel Molino",
        "func": "if(msg.payload.value > 3 && msg.payload.value <45){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 1760,
        "wires": [
            [
                "58f5dcf51b90debc"
            ]
        ]
    },
    {
        "id": "520d0c0a4d27acd8",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "subscription data",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "switch",
                "v": "1",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:Viento:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "speed",
                "vt": "str"
            },
            {
                "p": "molino",
                "v": "true",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "subscriptionWindSpeed",
        "payload": "{\"description\":\"Suscripci√≥n a cambios del dispositivo lamp001\",\"subject\":{\"entities\":[{\"id\":\"urn:ngsi-ld:Lamp:001\",\"type\":\"Thing\"}],\"condition\":{\"attrs\":[\"on\"]}},\"notification\":{\"httpCustom\":{\"url\":\"https://node-red:1880/notify\"},\"attrs\":[\"on\"]},\"expires\":\"2025-01-21T12:00:00.00Z\",\"throttling\":5}",
        "payloadType": "json",
        "x": 220,
        "y": 1760,
        "wires": [
            [
                "6ab40c48b2acc1c8"
            ]
        ]
    },
    {
        "id": "6ab40c48b2acc1c8",
        "type": "trigger",
        "z": "e2ba746ef9983a33",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 420,
        "y": 1760,
        "wires": [
            [
                "c14bc81f585d700f"
            ]
        ]
    },
    {
        "id": "39b4a96a9b77d2ad",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 1760,
        "wires": [
            [
                "d46d4b4d280c5617",
                "3d0d742f44eac3d9"
            ]
        ]
    },
    {
        "id": "c14bc81f585d700f",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 610,
        "y": 1760,
        "wires": [
            [
                "39b4a96a9b77d2ad"
            ]
        ]
    },
    {
        "id": "2ce9a2a3ad537c7c",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Suscripcion Velocidad Viento",
        "info": "",
        "x": 240,
        "y": 1720,
        "wires": []
    },
    {
        "id": "269c372cfd3a8fd5",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Actualizar cambios de molino a orion",
        "info": "",
        "x": 260,
        "y": 1820,
        "wires": []
    },
    {
        "id": "84f7377fa3d720b3",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Molino",
        "info": "",
        "x": 130,
        "y": 1600,
        "wires": []
    },
    {
        "id": "35c7c7df732467ff",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Agente",
        "info": "",
        "x": 130,
        "y": 1660,
        "wires": []
    },
    {
        "id": "58f5dcf51b90debc",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "molino_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "molino_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1130,
        "y": 1760,
        "wires": [
            [],
            [
                "be42fe0407a0ed09",
                "0f3316215f443658"
            ]
        ]
    },
    {
        "id": "be42fe0407a0ed09",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "molino_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 1760,
        "wires": [
            [
                "0913c8aba8283fda"
            ]
        ]
    },
    {
        "id": "0913c8aba8283fda",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "debug 20",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1600,
        "y": 1760,
        "wires": []
    },
    {
        "id": "0f3316215f443658",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 15",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1310,
        "y": 1820,
        "wires": [
            [
                "dd9d33d56ee2a270"
            ]
        ]
    },
    {
        "id": "dd9d33d56ee2a270",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 1820,
        "wires": [
            [
                "2e7ab4198e82e3e8"
            ]
        ]
    },
    {
        "id": "2e7ab4198e82e3e8",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1680,
        "y": 1820,
        "wires": [
            [
                "aacd0a9cf912ede7"
            ]
        ]
    },
    {
        "id": "002a4df31b0d1159",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2000,
        "y": 1840,
        "wires": [
            [
                "22a8744538491cda"
            ]
        ]
    },
    {
        "id": "22a8744538491cda",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2190,
        "y": 1820,
        "wires": []
    },
    {
        "id": "aacd0a9cf912ede7",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1860,
        "y": 1820,
        "wires": [
            [
                "22a8744538491cda"
            ],
            [
                "002a4df31b0d1159"
            ]
        ]
    },
    {
        "id": "e6fe8b8bfb0bb53c",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Automatizacion Bateria",
        "info": "",
        "x": 180,
        "y": 1900,
        "wires": []
    },
    {
        "id": "400df602a8e8a2a4",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Bateria",
        "info": "",
        "x": 130,
        "y": 1960,
        "wires": []
    },
    {
        "id": "3bbcc848a66a6f87",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "Control Temp Bater√≠a",
        "func": "if(msg.payload.value < 30){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 2100,
        "wires": [
            [
                "fc52591804c3014d"
            ]
        ]
    },
    {
        "id": "14b12f4e6dcbb2c2",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "subscription data",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "switch",
                "v": "1",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:TBateria:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "temp",
                "vt": "str"
            },
            {
                "p": "molino",
                "v": "true",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "subscriptionWindSpeed",
        "payload": "{\"description\":\"Suscripci√≥n a cambios del dispositivo lamp001\",\"subject\":{\"entities\":[{\"id\":\"urn:ngsi-ld:Lamp:001\",\"type\":\"Thing\"}],\"condition\":{\"attrs\":[\"on\"]}},\"notification\":{\"httpCustom\":{\"url\":\"https://node-red:1880/notify\"},\"attrs\":[\"on\"]},\"expires\":\"2025-01-21T12:00:00.00Z\",\"throttling\":5}",
        "payloadType": "json",
        "x": 220,
        "y": 2100,
        "wires": [
            [
                "707ccae4ffff86dc"
            ]
        ]
    },
    {
        "id": "707ccae4ffff86dc",
        "type": "trigger",
        "z": "e2ba746ef9983a33",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 440,
        "y": 2100,
        "wires": [
            [
                "0c1c828f3ce537b2"
            ]
        ]
    },
    {
        "id": "0db573be969a0d3f",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 830,
        "y": 2100,
        "wires": [
            [
                "3bbcc848a66a6f87",
                "59b0de493be5191e"
            ]
        ]
    },
    {
        "id": "0c1c828f3ce537b2",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 650,
        "y": 2100,
        "wires": [
            [
                "0db573be969a0d3f"
            ]
        ]
    },
    {
        "id": "ac56d6daff491f78",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Suscripcion Temperatura Bateria",
        "info": "",
        "x": 250,
        "y": 2060,
        "wires": []
    },
    {
        "id": "84104aa726851cd0",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Actuador",
        "info": "",
        "x": 180,
        "y": 2000,
        "wires": []
    },
    {
        "id": "fc52591804c3014d",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "bateria_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "bateria_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1230,
        "y": 2100,
        "wires": [
            [],
            [
                "b0c2a4cbf8828fcc",
                "909de7566be476b6"
            ]
        ]
    },
    {
        "id": "b0c2a4cbf8828fcc",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bateria_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1460,
        "y": 2060,
        "wires": [
            []
        ]
    },
    {
        "id": "909de7566be476b6",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 16",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1410,
        "y": 2120,
        "wires": [
            [
                "6a1f63e590612e81"
            ]
        ]
    },
    {
        "id": "6a1f63e590612e81",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1590,
        "y": 2120,
        "wires": [
            [
                "8de16f1b19421743"
            ]
        ]
    },
    {
        "id": "8de16f1b19421743",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1780,
        "y": 2120,
        "wires": [
            [
                "c5b068f4dfea2f16"
            ]
        ]
    },
    {
        "id": "6818125891347439",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2100,
        "y": 2140,
        "wires": [
            [
                "269e93cb745c3dd1"
            ]
        ]
    },
    {
        "id": "269e93cb745c3dd1",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2290,
        "y": 2120,
        "wires": []
    },
    {
        "id": "c5b068f4dfea2f16",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1960,
        "y": 2120,
        "wires": [
            [
                "269e93cb745c3dd1"
            ],
            [
                "6818125891347439"
            ]
        ]
    },
    {
        "id": "699b93fec5e82f3f",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Automatizacion Ventiladores",
        "info": "",
        "x": 200,
        "y": 2180,
        "wires": []
    },
    {
        "id": "6423274eb3826bc6",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "Control Calidad Aire",
        "func": "if(msg.payload.value <50){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 2400,
        "wires": [
            [
                "2823975c81ebadbd"
            ]
        ]
    },
    {
        "id": "8634ef92e8b668a0",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "subscription data",
        "props": [
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:Calidad:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "quality",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 2400,
        "wires": [
            [
                "b24ca7f833d49c71"
            ]
        ]
    },
    {
        "id": "b24ca7f833d49c71",
        "type": "trigger",
        "z": "e2ba746ef9983a33",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 420,
        "y": 2400,
        "wires": [
            [
                "b045ed5754f6a9b9"
            ]
        ]
    },
    {
        "id": "537bf8b18c145a2d",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 2400,
        "wires": [
            [
                "6423274eb3826bc6",
                "fd2a5a4a23657f69"
            ]
        ]
    },
    {
        "id": "b045ed5754f6a9b9",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 610,
        "y": 2400,
        "wires": [
            [
                "537bf8b18c145a2d"
            ]
        ]
    },
    {
        "id": "ad47e7a1109a33a7",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Suscripcion Calidad Aire",
        "info": "",
        "x": 230,
        "y": 2360,
        "wires": []
    },
    {
        "id": "7de0931f53de2352",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Actualizar cambios de molino a orion",
        "info": "",
        "x": 260,
        "y": 2460,
        "wires": []
    },
    {
        "id": "ccb5950767b31419",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Ventilador",
        "info": "",
        "x": 140,
        "y": 2240,
        "wires": []
    },
    {
        "id": "0376af950d93e7d9",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Actuador",
        "info": "",
        "x": 180,
        "y": 2300,
        "wires": []
    },
    {
        "id": "2823975c81ebadbd",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "ventilador_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "ventilador_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1130,
        "y": 2400,
        "wires": [
            [],
            [
                "dfae7c08372f37b1",
                "05d401214a680075"
            ]
        ]
    },
    {
        "id": "dfae7c08372f37b1",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ventilador_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 2400,
        "wires": [
            [
                "fef7cae50819b53a"
            ]
        ]
    },
    {
        "id": "fef7cae50819b53a",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "debug 23",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1600,
        "y": 2400,
        "wires": []
    },
    {
        "id": "05d401214a680075",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 17",
        "func": "\nmsg.payload = {\n    \"on\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1310,
        "y": 2460,
        "wires": [
            [
                "3bdb2fd1db67a6ef"
            ]
        ]
    },
    {
        "id": "3bdb2fd1db67a6ef",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Ventilador:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 2460,
        "wires": [
            [
                "10b71b5dde5442ef",
                "f480e869320968d6"
            ]
        ]
    },
    {
        "id": "10b71b5dde5442ef",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1680,
        "y": 2460,
        "wires": [
            [
                "706574622cedf685"
            ]
        ]
    },
    {
        "id": "53602547bd9d1720",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2190,
        "y": 2460,
        "wires": []
    },
    {
        "id": "706574622cedf685",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1860,
        "y": 2460,
        "wires": [
            [
                "53602547bd9d1720"
            ],
            [
                "2a9564a855ed67cd"
            ]
        ]
    },
    {
        "id": "2a9564a855ed67cd",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2000,
        "y": 2480,
        "wires": [
            [
                "53602547bd9d1720"
            ]
        ]
    },
    {
        "id": "f480e869320968d6",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "debug 25",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1650,
        "y": 2580,
        "wires": []
    },
    {
        "id": "98fc0fd5d0170e66",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Actuador",
        "info": "",
        "x": 180,
        "y": 2620,
        "wires": []
    },
    {
        "id": "6de0e602b3650d86",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "Control Cantidad Agua",
        "func": "if(msg.payload.value <25){\n    msg.payload = true;\n} else if (msg.payload.value > 95) {\n    msg.payload = false;\n}\nelse msg.payload = msg.compuerta_prev_state\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 2720,
        "wires": [
            [
                "01d88018f026a642"
            ]
        ]
    },
    {
        "id": "6346c1eb25376c66",
        "type": "inject",
        "z": "e2ba746ef9983a33",
        "name": "subscription data",
        "props": [
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:CapacidadTanque:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "capacity",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 2720,
        "wires": [
            [
                "f87e6acf0421aa21"
            ]
        ]
    },
    {
        "id": "f87e6acf0421aa21",
        "type": "trigger",
        "z": "e2ba746ef9983a33",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 420,
        "y": 2720,
        "wires": [
            [
                "a3d6f4caeceaea18"
            ]
        ]
    },
    {
        "id": "8f1aa3c9d3399318",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 2720,
        "wires": [
            [
                "d91a7455ef826900",
                "8cc7a16669be388b"
            ]
        ]
    },
    {
        "id": "a3d6f4caeceaea18",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 610,
        "y": 2720,
        "wires": [
            [
                "8f1aa3c9d3399318"
            ]
        ]
    },
    {
        "id": "07ce2727fc27c5f0",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Suscripcion Cantidad Tanque",
        "info": "",
        "x": 240,
        "y": 2680,
        "wires": []
    },
    {
        "id": "01d88018f026a642",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "compuerta_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "compuerta_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1410,
        "y": 2720,
        "wires": [
            [],
            [
                "4905c6e9cb66748a",
                "87e33b63f02f415a"
            ]
        ]
    },
    {
        "id": "4905c6e9cb66748a",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1670,
        "y": 2720,
        "wires": [
            [
                "be187a718c8a1147"
            ]
        ]
    },
    {
        "id": "be187a718c8a1147",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "debug 19",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1880,
        "y": 2720,
        "wires": []
    },
    {
        "id": "f222b71866e3f404",
        "type": "comment",
        "z": "e2ba746ef9983a33",
        "name": "Automatizacion Compuertas agua",
        "info": "",
        "x": 220,
        "y": 2560,
        "wires": []
    },
    {
        "id": "3d0d742f44eac3d9",
        "type": "ui_gauge",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "compass",
        "title": "Velocidad Viento",
        "label": "Km/h",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#f5c211",
            "#c01c28"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 950,
        "y": 1700,
        "wires": []
    },
    {
        "id": "fd2a5a4a23657f69",
        "type": "ui_gauge",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "4",
        "gtype": "gage",
        "title": "Calidad Aire",
        "label": "%",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#c01c28",
            "#e5a50a",
            "#26a269"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 930,
        "y": 2340,
        "wires": []
    },
    {
        "id": "d91a7455ef826900",
        "type": "ui_gauge",
        "z": "e2ba746ef9983a33",
        "name": "",
        "group": "95bc0ee9d93efab4",
        "order": 1,
        "width": "8",
        "height": "10",
        "gtype": "wave",
        "title": "Capacidad Tanque",
        "label": "%",
        "format": "{{msg.payload.value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#f5c211",
            "#c01c28"
        ],
        "seg1": "30",
        "seg2": "50",
        "diff": false,
        "className": "",
        "x": 970,
        "y": 2660,
        "wires": []
    },
    {
        "id": "b2906e4aca56660a",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 10",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 1120,
        "wires": [
            [
                "557ce5d4dee267bc"
            ]
        ]
    },
    {
        "id": "557ce5d4dee267bc",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 1120,
        "wires": [
            [
                "8333e4d62a95c7b1"
            ]
        ]
    },
    {
        "id": "8333e4d62a95c7b1",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1250,
        "y": 1120,
        "wires": [
            [
                "85a357974a66ec47"
            ]
        ]
    },
    {
        "id": "515447a9624b55ba",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1570,
        "y": 1140,
        "wires": [
            [
                "e01fec3883eb4853"
            ]
        ]
    },
    {
        "id": "e01fec3883eb4853",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1760,
        "y": 1120,
        "wires": []
    },
    {
        "id": "85a357974a66ec47",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1430,
        "y": 1120,
        "wires": [
            [
                "e01fec3883eb4853"
            ],
            [
                "515447a9624b55ba"
            ]
        ]
    },
    {
        "id": "87e33b63f02f415a",
        "type": "function",
        "z": "e2ba746ef9983a33",
        "name": "function 18",
        "func": "\nmsg.payload = {\n    \"locked\": {\n        \"value\": msg.payload\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1610,
        "y": 2780,
        "wires": [
            [
                "f108a0350b9ed589"
            ]
        ]
    },
    {
        "id": "f108a0350b9ed589",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "orion_ip",
                "pt": "msg",
                "to": "orion_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "orion_puerto",
                "pt": "msg",
                "to": "orion_puerto",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "entity_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Compuertas:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1790,
        "y": 2780,
        "wires": [
            [
                "5aa493d0f517a2dd"
            ]
        ]
    },
    {
        "id": "5aa493d0f517a2dd",
        "type": "http request",
        "z": "e2ba746ef9983a33",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{orion_ip}}}:{{{orion_puerto}}}/v2/entities/{{{entity_id}}}/attrs",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 1980,
        "y": 2780,
        "wires": [
            [
                "d24509f3d1dd95e0"
            ]
        ]
    },
    {
        "id": "9932f5bbfd89aa5a",
        "type": "json",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2300,
        "y": 2800,
        "wires": [
            [
                "4de1841fb4448273"
            ]
        ]
    },
    {
        "id": "d24509f3d1dd95e0",
        "type": "switch",
        "z": "e2ba746ef9983a33",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2160,
        "y": 2780,
        "wires": [
            [
                "4de1841fb4448273"
            ],
            [
                "9932f5bbfd89aa5a"
            ]
        ]
    },
    {
        "id": "4de1841fb4448273",
        "type": "debug",
        "z": "e2ba746ef9983a33",
        "name": "update devices",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2490,
        "y": 2780,
        "wires": []
    },
    {
        "id": "8cc7a16669be388b",
        "type": "change",
        "z": "e2ba746ef9983a33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "compuerta_prev_state",
                "pt": "msg",
                "to": "compuerta_prev_state",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 990,
        "y": 2760,
        "wires": [
            [
                "6de0e602b3650d86"
            ]
        ]
    },
    {
        "id": "abbc5b966f95616a",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolino",
        "topic": "updateMolino",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 660,
        "y": 240,
        "wires": []
    },
    {
        "id": "ab054733f7fdaa36",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "em001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 120,
        "y": 40,
        "wires": [
            [
                "3e934c82f7b216c1"
            ]
        ]
    },
    {
        "id": "3e934c82f7b216c1",
        "type": "http request",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 310,
        "y": 40,
        "wires": [
            [
                "807c489b186061e3"
            ]
        ]
    },
    {
        "id": "f88ec5bbaf68da8d",
        "type": "mqtt in",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "topic": "updateMolinoOrion",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 290,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "807c489b186061e3",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 490,
        "y": 40,
        "wires": [
            [
                "0b60eee3df077c10"
            ],
            [
                "ab2e0252629afd26"
            ]
        ]
    },
    {
        "id": "ab2e0252629afd26",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 610,
        "y": 120,
        "wires": [
            [
                "0b60eee3df077c10"
            ]
        ]
    },
    {
        "id": "0b60eee3df077c10",
        "type": "debug",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolino: StatusCode",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "statusCode",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 40,
        "wires": []
    },
    {
        "id": "a1c0815b8c22ec2e",
        "type": "mqtt in",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "checkUpdateBateriaOrion",
        "topic": "checkUpdateBateriaOrion",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 340,
        "wires": [
            [
                "17108480951cb4c9"
            ]
        ]
    },
    {
        "id": "fb126ee76e0151da",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 710,
        "y": 340,
        "wires": [
            [
                "f5927a87202b42ee"
            ]
        ]
    },
    {
        "id": "e4f3b4979d4a2ee2",
        "type": "http request",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/on",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 550,
        "y": 340,
        "wires": [
            [
                "fb126ee76e0151da"
            ]
        ]
    },
    {
        "id": "17108480951cb4c9",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Bateria:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "wilma_ip",
                "pt": "msg",
                "to": "wilma_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "wilma_port",
                "pt": "msg",
                "to": "wilma_port",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "bateria",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 340,
        "wires": [
            [
                "e4f3b4979d4a2ee2"
            ]
        ]
    },
    {
        "id": "f5927a87202b42ee",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "statusCode",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "200",
                "vt": "num"
            },
            {
                "t": "neq",
                "v": "200",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 850,
        "y": 340,
        "wires": [
            [
                "533050219405bc5f"
            ],
            [
                "82194e9cbcfbb636"
            ]
        ]
    },
    {
        "id": "533050219405bc5f",
        "type": "function",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Check valor bateria",
        "func": "if (msg.payload.value != msg.bateria.on){\n    msg.payload = msg.bateria\n    msg.update = true\n}else{\n    msg.update = false\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1050,
        "y": 300,
        "wires": [
            [
                "8156af339a4f815d"
            ]
        ]
    },
    {
        "id": "973548b408735e72",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateBateriaOrion",
        "topic": "updateBateriaOrion",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1250,
        "y": 380,
        "wires": []
    },
    {
        "id": "82194e9cbcfbb636",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "bateria",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1040,
        "y": 380,
        "wires": [
            [
                "973548b408735e72"
            ]
        ]
    },
    {
        "id": "8156af339a4f815d",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "update",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1210,
        "y": 300,
        "wires": [
            [
                "4da4408f9c47a35f"
            ],
            []
        ]
    },
    {
        "id": "4da4408f9c47a35f",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateBateriaOrion",
        "topic": "updateBateriaOrion",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1390,
        "y": 300,
        "wires": []
    },
    {
        "id": "91df951f7be7544e",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Coomprobar si molino debe actualizar sus cambios a orion",
        "info": "",
        "x": 230,
        "y": 300,
        "wires": []
    },
    {
        "id": "b32367ac58616b44",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Actuador",
        "info": "",
        "x": 120,
        "y": 460,
        "wires": []
    },
    {
        "id": "4d40b9565ab130a9",
        "type": "mqtt in",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolino",
        "topic": "updateMolino",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 500,
        "wires": [
            [
                "8a61a72ef1e2cf16"
            ]
        ]
    },
    {
        "id": "04f30c9fb938f1d0",
        "type": "function",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Control Vel Molino",
        "func": "if(msg.payload.value > 3 && msg.payload.value <45){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 680,
        "wires": [
            [
                "b8870adbca145ae8"
            ]
        ]
    },
    {
        "id": "eb3b156e5558787b",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolino",
        "topic": "updateMolino",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 1320,
        "y": 680,
        "wires": []
    },
    {
        "id": "09cbc4af3f3c54f0",
        "type": "inject",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "subscription data",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            },
            {
                "p": "wilma_ip",
                "v": "wilma_ip",
                "vt": "flow"
            },
            {
                "p": "wilma_port",
                "v": "wilma_port",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "switch",
                "v": "1",
                "vt": "str"
            },
            {
                "p": "device_id",
                "v": "urn:ngsi-ld:Viento:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "speed",
                "vt": "str"
            },
            {
                "p": "molino",
                "v": "true",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "subscriptionWindSpeed",
        "payload": "{\"description\":\"Suscripci√≥n a cambios del dispositivo lamp001\",\"subject\":{\"entities\":[{\"id\":\"urn:ngsi-ld:Lamp:001\",\"type\":\"Thing\"}],\"condition\":{\"attrs\":[\"on\"]}},\"notification\":{\"httpCustom\":{\"url\":\"https://node-red:1880/notify\"},\"attrs\":[\"on\"]},\"expires\":\"2025-01-21T12:00:00.00Z\",\"throttling\":5}",
        "payloadType": "json",
        "x": 200,
        "y": 680,
        "wires": [
            [
                "988df23c58d32198"
            ]
        ]
    },
    {
        "id": "988df23c58d32198",
        "type": "trigger",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "op1": "1",
        "op2": "0",
        "op1type": "str",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 680,
        "wires": [
            [
                "e3176ff5894dfe80"
            ]
        ]
    },
    {
        "id": "000f7e571ad5f2ec",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 680,
        "wires": [
            [
                "04f30c9fb938f1d0"
            ]
        ]
    },
    {
        "id": "e3176ff5894dfe80",
        "type": "http request",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/{{{attr}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 590,
        "y": 680,
        "wires": [
            [
                "000f7e571ad5f2ec"
            ]
        ]
    },
    {
        "id": "aa05e5e0cd5e2e5c",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Suscripcion Velocidad Viento",
        "info": "",
        "x": 220,
        "y": 640,
        "wires": []
    },
    {
        "id": "775fd1571554af15",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "topic": "updateMolinoOrion",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 690,
        "y": 500,
        "wires": []
    },
    {
        "id": "8ed92a3b7f6c652d",
        "type": "mqtt in",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "checkUpdateMolinoOrion",
        "topic": "checkUpdateMolinoOrion",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1470,
        "y": 800,
        "wires": [
            [
                "5c07971bf8622582"
            ]
        ]
    },
    {
        "id": "f790105d940a25c2",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "em001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 780,
        "wires": [
            [
                "0e860fcd7a8f9d84"
            ]
        ]
    },
    {
        "id": "0e860fcd7a8f9d84",
        "type": "http request",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 590,
        "y": 780,
        "wires": [
            [
                "3495aac16637a6cc"
            ]
        ]
    },
    {
        "id": "3495aac16637a6cc",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 750,
        "y": 780,
        "wires": [
            [
                "e57d3693586feba2"
            ],
            [
                "bf143eed66a40fda"
            ]
        ]
    },
    {
        "id": "bf143eed66a40fda",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 910,
        "y": 820,
        "wires": [
            [
                "e57d3693586feba2"
            ]
        ]
    },
    {
        "id": "8a61a72ef1e2cf16",
        "type": "function",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Update valor en molino",
        "func": "msg.payload = {'on': msg.payload}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 500,
        "wires": [
            [
                "775fd1571554af15"
            ]
        ]
    },
    {
        "id": "b1da809c81d7e412",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2250,
        "y": 800,
        "wires": [
            [
                "f28c5ed46fb03d63"
            ]
        ]
    },
    {
        "id": "d81f511c5b707cb9",
        "type": "http request",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{wilma_ip}}}:{{{wilma_port}}}/v2/entities/{{{device_id}}}/attrs/on",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 2090,
        "y": 800,
        "wires": [
            [
                "b1da809c81d7e412"
            ]
        ]
    },
    {
        "id": "5c07971bf8622582",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "urn:ngsi-ld:Molino:001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "wilma_ip",
                "pt": "msg",
                "to": "wilma_ip",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "wilma_port",
                "pt": "msg",
                "to": "wilma_port",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "molino",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1900,
        "y": 800,
        "wires": [
            [
                "d81f511c5b707cb9"
            ]
        ]
    },
    {
        "id": "f28c5ed46fb03d63",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "statusCode",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "200",
                "vt": "num"
            },
            {
                "t": "neq",
                "v": "200",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2390,
        "y": 800,
        "wires": [
            [
                "812d109404b530d2"
            ],
            [
                "33b3a3d9cce19ab8"
            ]
        ]
    },
    {
        "id": "812d109404b530d2",
        "type": "function",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Check valor molino",
        "func": "if(msg.payload.value != msg.molino.on){\n    msg.payload = msg.molino\n    msg.update = true\n}else{\n    msg.update = false\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2590,
        "y": 760,
        "wires": [
            [
                "9c33a3a514b0d9f8"
            ]
        ]
    },
    {
        "id": "31af5e088988e762",
        "type": "mqtt in",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "topic": "updateMolinoOrion",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 780,
        "wires": [
            [
                "f790105d940a25c2"
            ]
        ]
    },
    {
        "id": "d4f56d2b5939d961",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolinoOrion",
        "topic": "updateMolinoOrion",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 2790,
        "y": 840,
        "wires": []
    },
    {
        "id": "33b3a3d9cce19ab8",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "molino",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2580,
        "y": 840,
        "wires": [
            [
                "d4f56d2b5939d961"
            ]
        ]
    },
    {
        "id": "e57d3693586feba2",
        "type": "debug",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolino: StatusCode",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "statusCode",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1140,
        "y": 780,
        "wires": []
    },
    {
        "id": "9c33a3a514b0d9f8",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "update",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2750,
        "y": 760,
        "wires": [
            [
                "2b99ba59a72ba17b"
            ],
            []
        ]
    },
    {
        "id": "2b99ba59a72ba17b",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateMolinoOrion",
        "topic": "updateMolinoOrion",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 2930,
        "y": 760,
        "wires": []
    },
    {
        "id": "5bea39a9c821daa0",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Coomprobar si molino debe actualizar sus cambios a orion",
        "info": "",
        "x": 1770,
        "y": 760,
        "wires": []
    },
    {
        "id": "6d49d5942e41f25a",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Actualizar cambios de molino a orion",
        "info": "",
        "x": 240,
        "y": 740,
        "wires": []
    },
    {
        "id": "052dc90f1ffdf9c3",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Molino",
        "info": "",
        "x": 70,
        "y": 400,
        "wires": []
    },
    {
        "id": "ca0686a1d586541f",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Agente",
        "info": "",
        "x": 110,
        "y": 580,
        "wires": []
    },
    {
        "id": "b8870adbca145ae8",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "molino_prev_state",
                "vt": "flow"
            },
            {
                "t": "neq",
                "v": "molino_prev_state",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1110,
        "y": 680,
        "wires": [
            [],
            [
                "8db20d589d97b466",
                "eb3b156e5558787b"
            ]
        ]
    },
    {
        "id": "8db20d589d97b466",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "molino_prev_state",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 720,
        "wires": [
            [
                "44815a9c521c1818"
            ]
        ]
    },
    {
        "id": "44815a9c521c1818",
        "type": "debug",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "debug 17",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1580,
        "y": 720,
        "wires": []
    },
    {
        "id": "ae23efd526b99d06",
        "type": "inject",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "temp_bateria",
                "v": "temp_bateria",
                "vt": "flow"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "electricidad/tbateria",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "7834bc5e8abe10a2",
        "type": "inject",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "velocidad_viento",
                "v": "velocidad_viento",
                "vt": "flow"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "electricidad/viento",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "02bdcb3a0fc330ed",
        "type": "change",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fiware_service",
                "pt": "msg",
                "to": "fiware_service",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "fiware_servicepath",
                "pt": "msg",
                "to": "fiware_servicepath",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_ip",
                "pt": "msg",
                "to": "iota_ip",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "iota_puerto_datos",
                "pt": "msg",
                "to": "iota_puerto_datos",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "api_key",
                "pt": "msg",
                "to": "1234567890",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "device_id",
                "pt": "msg",
                "to": "eb001",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "oauth2-token",
                "pt": "msg",
                "to": "oauth2-token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 1480,
        "wires": [
            [
                "fe66b7d77ef08a5a"
            ]
        ]
    },
    {
        "id": "fe66b7d77ef08a5a",
        "type": "http request",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://{{{iota_ip}}}:{{{iota_puerto_datos}}}/iot/json?k={{{api_key}}}&i={{{device_id}}}",
        "tls": "a5e11d29c103c79c",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Fiware-Service",
                "valueType": "msg",
                "valueValue": "fiware_service"
            },
            {
                "keyType": "other",
                "keyValue": "Fiware-ServicePath",
                "valueType": "msg",
                "valueValue": "fiware_servicepath"
            },
            {
                "keyType": "other",
                "keyValue": "Content-Type",
                "valueType": "other",
                "valueValue": "application/json"
            },
            {
                "keyType": "other",
                "keyValue": "X-Auth-token",
                "valueType": "msg",
                "valueValue": "oauth2-token"
            }
        ],
        "x": 530,
        "y": 1480,
        "wires": [
            [
                "f844e23e5c19b3f6"
            ]
        ]
    },
    {
        "id": "f844e23e5c19b3f6",
        "type": "switch",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 690,
        "y": 1480,
        "wires": [
            [
                "3b197d60d42f298a"
            ],
            [
                "a01e0c3ea0d4fdfd"
            ]
        ]
    },
    {
        "id": "a01e0c3ea0d4fdfd",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 1520,
        "wires": [
            [
                "3b197d60d42f298a"
            ]
        ]
    },
    {
        "id": "afe2425f837dfb98",
        "type": "mqtt in",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateBateriaOrion",
        "topic": "updateBateriaOrion",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "405695e50f5ae861",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 1480,
        "wires": [
            [
                "02bdcb3a0fc330ed"
            ]
        ]
    },
    {
        "id": "3b197d60d42f298a",
        "type": "debug",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "updateBateria: StatusCode",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "statusCode",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 1480,
        "wires": []
    },
    {
        "id": "4c6a65f8cc71aac8",
        "type": "comment",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "Actualizar cambios de molino a orion",
        "info": "",
        "x": 180,
        "y": 1440,
        "wires": []
    },
    {
        "id": "51907a6f91a622d0",
        "type": "json",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 310,
        "y": 1620,
        "wires": [
            []
        ]
    },
    {
        "id": "444ec13164ac0703",
        "type": "mqtt out",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "topic": "updateBateriaOrion",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "405695e50f5ae861",
        "x": 150,
        "y": 1620,
        "wires": []
    },
    {
        "id": "d64444eceebe1157",
        "type": "inject",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Viento:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "speed",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 160,
        "y": 1740,
        "wires": [
            [
                "9313edf5e696f362"
            ]
        ]
    },
    {
        "id": "9313edf5e696f362",
        "type": "trigger",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 320,
        "y": 1780,
        "wires": [
            []
        ]
    },
    {
        "id": "c95a8dcb797cbf92",
        "type": "inject",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:Calidad:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "quality",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 600,
        "y": 1900,
        "wires": [
            [
                "84f08a8ecd9a7ffa"
            ]
        ]
    },
    {
        "id": "84f08a8ecd9a7ffa",
        "type": "trigger",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "-2",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 740,
        "y": 1940,
        "wires": [
            []
        ]
    },
    {
        "id": "6e08aa230ef77176",
        "type": "inject",
        "z": "98a5db9935e06314",
        "d": true,
        "name": "execute request",
        "props": [
            {
                "p": "orion_ip",
                "v": "orion_ip",
                "vt": "flow"
            },
            {
                "p": "orion_puerto",
                "v": "orion_puerto",
                "vt": "flow"
            },
            {
                "p": "fiware_service",
                "v": "fiware_service",
                "vt": "flow"
            },
            {
                "p": "fiware_servicepath",
                "v": "fiware_servicepath",
                "vt": "flow"
            },
            {
                "p": "entity_id",
                "v": "urn:ngsi-ld:TBateria:001",
                "vt": "str"
            },
            {
                "p": "attr",
                "v": "temp",
                "vt": "str"
            },
            {
                "p": "oauth2-token",
                "v": "oauth2-token",
                "vt": "global"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 1980,
        "wires": [
            []
        ]
    }
]